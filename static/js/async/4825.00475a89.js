"use strict";(self.webpackChunkvue2_demo=self.webpackChunkvue2_demo||[]).push([["4825"],{51661:function(e,t,n){n.r(t),n.d(t,{TagControlRenderer:()=>I,default:()=>F});var i=n(9787),a=n(65758),r=n(47755),s=n(17949),o=n(33170),l=n.n(o),u=n(96789),p=n.n(u),d=n(23804),c=n.n(d),h=n(72976),g=n.n(h),m=n(4363),v=n.n(m),y=n(97326),f=n(68333),w=n(81415),O=n(8427),F=function(e){function t(t){var n=e.call(this,t)||this;return n.input=a.createRef(),n.state={isOpened:!1,inputValue:"",isFocused:!1,selectedOptions:t.selectedOptions,cacheOptions:[]},n}return(0,i.ZT)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.props;e.value!==t.value&&this.setState({inputValue:""})},t.prototype.doAction=function(e,t,n){var i,a,s=this.props,o=s.resetValue,l=s.onChange,u=s.formStore,p=s.store,d=s.name,c=null==e?void 0:e.actionType;if("clear"===c)null==l||l("");else if("reset"===c){var h=null!=(a=(0,r.E04)(null!=(i=null==u?void 0:u.pristine)?i:null==p?void 0:p.pristine,d))?a:o;null==l||l(null!=h?h:"")}},t.prototype.dispatchEvent=function(e,t){return void 0===t&&(t={}),(0,i.mG)(this,void 0,void 0,function(){var n,a,s,o;return(0,i.Jh)(this,function(l){switch(l.label){case 0:return a=(n=this.props).dispatchEvent,s=n.options,[4,a(e,(0,r.vXk)(this.props,(0,i.pi)({options:s,items:s},t)))];case 1:return[2,!!(null==(o=l.sent())?void 0:o.prevented)]}})})},t.prototype.normalizeInputValue=function(e){var t=this.props,n=t.enableBatchAdd,a=t.separator,r=t.valueField,s=t.labelField,o=t.delimiter,l=[];if(n&&a&&"string"==typeof a)l=e.split(a);else{var u=v()(g()(e.split(o||",")));l.push.apply(l,(0,i.ev)([],(0,i.CR)(u),!1))}return l.filter(Boolean).map(function(e){var t;return(t={})["".concat(r||"value")]=e,t["".concat(s||"label")]=e,t})},t.prototype.normalizeOptions=function(e){var t=this.props,n=t.joinValues,i=t.extractValue,a=t.delimiter,r=t.valueField;return n?e.map(function(e){return e[r||"value"]}).join(a||","):i?e.map(function(e){return e[r||"value"]}):e},t.prototype.normalizeMergedValue=function(e,t){void 0===t&&(t=!0);var n=this.props,i=n.selectedOptions,a=n.valueField,r=c()(i.concat(),this.normalizeInputValue(e),function(e,t){return e[a||"value"]===t[a||"value"]});return t?this.normalizeOptions(r):r},t.prototype.validateInputValue=function(e){var t=this.props,n=t.max,i=t.maxTagLength,a=(t.enableBatchAdd,t.separator,t.onInputValidateFailed),r=t.valueField,s=this.normalizeMergedValue(e,!1);if(null!=n&&p()(n)&&s.length>n)return null==a||a(s.map(function(e){return e[r||"value"]}),"max"),!1;var o=this.normalizeInputValue(e);return!(null!=i&&p()(i)&&o.some(function(e){return e[r||"value"].length>i}))||(null==a||a(o.map(function(e){return e[r||"value"]}),"maxLength"),!1)},t.prototype.getValue=function(e,t,n){void 0===e&&(e="normal"),void 0===t&&(t={});var i=this.props,a=i.joinValues,r=i.extractValue,s=i.delimiter,o=i.valueField,l=(n=n||this.props.selectedOptions).concat();return"push"===e?l.push(t):"pop"===e&&l.pop(),a?l.map(function(e){return e[o||"value"]}).join(s||","):r?l.map(function(e){return e[o||"value"]}):l},t.prototype.addItem=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,a,r,s,o;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(this.isReachMax()||(n=(t=this.props).selectedOptions,a=t.onChange,r=t.valueField,s=n.concat(),l()(s,function(t){return t[r||"value"]==e[r||"value"]})))return[2];return o=this.getValue("push",e),[4,this.dispatchEvent("change",{value:o,selectedItems:n.concat(e)})];case 1:return i.sent()||a(o),[2]}})})},t.prototype.addItem2=function(e){var t=this.props,n=t.mobileUI,i=t.valueField,a=void 0===i?"value":i;if(n){var r=this.state.selectedOptions.concat(),s=r.findIndex(function(t){return t[a]===e[a]});~s?r.splice(s,1):this.isReachMaxFromState()||r.push(e),this.setState({selectedOptions:r})}},t.prototype.isExist=function(e){var t=this.props,n=t.options,i=t.valueField,a=void 0===i?"value":i,r=this.state.cacheOptions;return n.some(function(t){return t[a]===e})||r.some(function(t){return t[a]===e})},t.prototype.addSelection=function(){var e=this.state.inputValue,t=this.props.maxTagLength,n=this.state.selectedOptions.slice(),i=this.state.cacheOptions.slice();if(void 0!==t&&(e=(e=e.trim()).slice(0,t)),!this.isExist(e)&&e&&!this.isReachMaxFromState()){var a=this.normalizeInputValue(e);n.push(a[0]),i.push(a[0]),this.setState({inputValue:"",selectedOptions:n,cacheOptions:i})}},t.prototype.onConfirm=function(){return(0,i.mG)(this,void 0,void 0,function(){var e,t,n;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return e=this.state.selectedOptions,t=this.props.onChange,n=this.getValue("normal",{},e),[4,this.dispatchEvent("change",{value:n,selectedItems:e})];case 1:return i.sent()||t(n),this.close(),[2]}})})},t.prototype.handleFocus=function(e){var t,n;return(0,i.mG)(this,void 0,void 0,function(){var a;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return this.setState({isFocused:!0,isOpened:!0,selectedOptions:this.props.selectedOptions}),a=this.getValue("normal"),[4,this.dispatchEvent("focus",{value:a,selectedItems:this.props.selectedOptions})];case 1:return i.sent()||null==(n=(t=this.props).onFocus)||n.call(t,e),[2]}})})},t.prototype.handleBlur=function(e){var t,n;return(0,i.mG)(this,void 0,void 0,function(){var a,r,s,o,l,u,p;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(r=(a=this.props).selectedOptions,s=a.onChange,o=a.mobileUI,l=a.options,o&&l.length)return[2];if(u=this.state.inputValue.trim(),!this.validateInputValue(u))return this.setState({isFocused:!1,isOpened:!1}),[2];return p=this.normalizeMergedValue(u),[4,this.dispatchEvent("blur",{value:p,selectedItems:r})];case 1:return i.sent()||null==(n=(t=this.props).onBlur)||n.call(t,e),this.setState({isFocused:!1,isOpened:!1,inputValue:""},u?function(){r.length!==p.length&&(null==s||s(p))}:void 0),[2]}})})},t.prototype.close=function(){this.setState({isOpened:!1})},t.prototype.handleInputChange=function(e){this.setState({inputValue:e})},t.prototype.handleChange=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,a,r,s,o,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return n=(t=this.props).joinValues,a=t.extractValue,r=t.delimiter,s=t.valueField,o=t.onChange,l=Array.isArray(e)?e.concat():[],(n||a)&&(l=e.map(function(e){return e[s||"value"]})),n&&(l=l.join(r||",")),[4,this.dispatchEvent("change",{value:l,selectedItems:e})];case 1:return i.sent()||o(l),[2]}})})},t.prototype.renderItem=function(e){var t=this.props.labelField;return"".concat(e[t||"label"])},t.prototype.handleKeyDown=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,a,r,s,o,l,u;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(n=(t=this.props).selectedOptions,a=t.onChange,r=t.delimiter,t.labelField,t.valueField,s=this.state.inputValue.trim(),o=n.concat(this.normalizeMergedValue(s,!1)),!(n.length&&!s&&"Backspace"==e.key))return[3,2];return l=this.getValue("pop"),[4,this.dispatchEvent("change",{value:l,selectedItems:o})];case 1:return(u=i.sent())||a(l),[3,5];case 2:if(!(s&&("Enter"===e.key||e.key===r)))return[3,4];return e.preventDefault(),e.stopPropagation(),l=this.normalizeMergedValue(s),[4,this.dispatchEvent("change",{value:l,selectedItems:o})];case 3:if(u=i.sent(),!this.validateInputValue(s))return this.setState({isFocused:!1,isOpened:!1}),[2];return u||n.length===l.length||a(l),this.setState({inputValue:""}),[3,5];case 4:s||"Enter"!==e.key||this.handleBlur(e),i.label=5;case 5:return[2]}})})},t.prototype.handleOptionChange=function(e){if(this.props.mobileUI)return void this.addItem2(e);!this.isReachMax()&&e&&this.addItem(e)},t.prototype.getTarget=function(){return this.input.current},t.prototype.getParent=function(){return this.input.current&&(0,y.findDOMNode)(this.input.current).parentElement},t.prototype.reload=function(){var e=this.props.reloadOptions;null==e||e()},t.prototype.isReachMax=function(){var e=this.props,t=e.max,n=e.selectedOptions;return null!=t&&p()(t)&&n.length>=t},t.prototype.isReachMaxFromState=function(){var e=this.state.selectedOptions,t=this.props.max;return null!=t&&p()(t)&&e.length>=t},t.prototype.render=function(){var e=this,t=this.props,n=t.className,o=(t.style,t.classnames),l=t.disabled,u=t.placeholder,p=t.name,d=t.clearable,c=t.selectedOptions,h=t.loading,g=t.popOverContainer,m=t.dropdown,v=t.options,y=t.optionsTip,w=t.maxTagCount,F=t.overflowTagPopover,I=t.translate,b=t.loadingConfig,C=t.valueField,V=t.env,x=t.mobileUI,E=t.labelField,j=t.testIdBuilder,N=this.state.inputValue,T=Array.isArray(v)?(0,r.get)(v,function(e,t,n,i){return void 0!==e[C||"value"]&&(x||!~c.indexOf(e))&&((0,O.Lu)([e].concat(i),N,{keys:[E||"label",C||"value"],threshold:O.Lu.rankings.CONTAINS}).length||Array.isArray(e.children)&&!!e.children.length)},0,!0):[],S=this.isReachMax();return a.createElement(s.ZP,{selectedItem:c,isOpen:x?this.state.isOpened:this.state.isFocused,inputValue:this.state.inputValue,onChange:this.handleOptionChange,itemToString:this.renderItem},function(t){var s=t.isOpen,O=t.highlightedIndex,E=t.getItemProps,N=t.getInputProps;return a.createElement("div",{className:o(n,"TagControl")},a.createElement(f.Al,(0,i.pi)({},N({name:p,ref:e.input,placeholder:I(null!=u?u:"Tag.placeholder"),value:e.state.inputValue,onKeyDown:e.handleKeyDown,onFocus:x?void 0:e.handleFocus,onBlur:e.handleBlur,disabled:l}),{onResultClick:x?e.handleFocus:void 0,inputPlaceholder:"",onChange:e.handleInputChange,className:o("TagControl-input"),result:c,onResultChange:e.handleChange,itemRender:e.renderItem,clearable:d,maxTagCount:w,overflowTagPopover:F,popOverContainer:g||V.getModalContainer,allowInput:!x||x&&!(null==v?void 0:v.length),mobileUI:x,testIdBuilder:null==j?void 0:j.getChild("resule-box")}),h?a.createElement(f.$j,{loadingConfig:b,size:"sm"}):void 0),!1!==m?x?a.createElement(f.N4,{className:o("Tag-popup"),container:x?null==V?void 0:V.getModalContainer:g||V.getModalContainer,isShow:s&&!!T.length,showConfirm:!0,onConfirm:e.onConfirm,onHide:e.close},a.createElement("div",null,a.createElement(f.QE,{selectedOptions:c,mobileUI:x,options:T.concat(e.state.cacheOptions),itemRender:e.renderItem,highlightIndex:O,getItemProps:function(t){var n=t.item,a=t.index;return(0,i.pi)({},E({index:a,item:n,className:o("ListMenu-item",{"is-active":~(e.state.selectedOptions.map(function(e){return e[C]})||[]).indexOf(n[C])})}))}}),x&&!e.isReachMaxFromState()?a.createElement("div",{className:o("ListMenu-add-wrap")},a.createElement(f.Al,{placeholder:I("placeholder.enter")+"...",allowInput:!0,value:e.state.inputValue,mobileUI:x,clearable:!0,maxTagCount:w,onChange:function(t){e.setState({inputValue:t})},onBlur:e.addSelection})):null)):a.createElement(r.aVW,{container:g||e.getParent,target:e.getTarget,placement:"auto",show:s&&!!T.length},a.createElement(r.v$m,{overlay:!0,className:o("TagControl-popover"),onHide:e.close},a.createElement(f.QE,{options:T,itemRender:e.renderItem,highlightIndex:O,testIdBuilder:null==j?void 0:j.getChild("options"),getItemProps:function(e){var t=e.item,n=e.index;return(0,i.pi)({},E({index:n,item:t,disabled:S||t.disabled,className:o("ListMenu-item",{"is-disabled":S})}))}}))):a.createElement("div",{className:o("TagControl-sug")},y?a.createElement("div",{className:o("TagControl-sugTip")},I(y)):null,v.map(function(t,n){return a.createElement("div",{className:o("TagControl-sugItem",{"is-disabled":t.disabled||l||S}),key:n,onClick:e.addItem.bind(e,t)},t.label)})))})},t.defaultProps={resetValue:"",labelField:"label",valueField:"value",multiple:!0,placeholder:"Tag.placeholder",optionsTip:"Tag.tip",separator:"-"},(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"dispatchEvent",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,Object,Array]),(0,i.w6)("design:returntype",void 0)],t.prototype,"getValue",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"addSelection",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",Promise)],t.prototype,"onConfirm",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"handleFocus",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"handleBlur",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"close",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleInputChange",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Array]),(0,i.w6)("design:returntype",Promise)],t.prototype,"handleChange",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Object)],t.prototype,"renderItem",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"handleKeyDown",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleOptionChange",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"getTarget",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"getParent",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"isReachMax",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"isReachMaxFromState",null),(0,i.gn)([(0,w.i)(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"render",null),t}(a.PureComponent),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t=(0,i.gn)([(0,r.oZB)({type:"input-tag"})],t)}(F)}}]);