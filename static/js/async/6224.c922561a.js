"use strict";(self.webpackChunkvue2_demo=self.webpackChunkvue2_demo||[]).push([["6224"],{33045:function(e,t,n){n.r(t),n.d(t,{TreeSelectControlRenderer:()=>c,default:()=>h});var i=n(9787),o=n(65758),r=n(47755),a=n(68333),l=n(8427),s=n(66292),p=n.n(s),d=n(97326),u=n(81415),h=function(e){function t(t){var n=e.call(this,t)||this;return n.container=o.createRef(),n.input=o.createRef(),n.cache={},n.targetRef=function(e){return n.target=e?(0,d.findDOMNode)(e):null},n.sourceLoaded=!1,n.state={inputValue:"",tempValue:"",isOpened:!1},n.open=n.open.bind(n),n.close=n.close.bind(n),n.handleChange=n.handleChange.bind(n),n.handleTempChange=n.handleTempChange.bind(n),n.handleConfirm=n.handleConfirm.bind(n),n.clearValue=n.clearValue.bind(n),n.handleFocus=n.handleFocus.bind(n),n.handleBlur=n.handleBlur.bind(n),n.handleKeyPress=n.handleKeyPress.bind(n),n.handleInputChange=p()(n.handleInputChange.bind(n),150,{trailing:!0,leading:!1}),n.handleInputKeyDown=n.handleInputKeyDown.bind(n),n.loadRemote=p()(n.loadRemote.bind(n),250,{trailing:!0,leading:!1}),n}return(0,i.ZT)(t,e),t.prototype.componentDidMount=function(){this.loadRemote("")},t.prototype.componentWillUnmount=function(){this.sourceLoaded=!1},t.prototype.open=function(e){this.props.disabled||this.setState({isOpened:!0},e)},t.prototype.close=function(){var e=this;this.setState({isOpened:!1,inputValue:this.props.multiple?this.state.inputValue:""},function(){return e.loadRemote(e.state.inputValue)})},t.prototype.resolveOptions=function(){var e=this.props,t=e.options,n=e.searchable,i=e.autoComplete;return!(0,r.X1t)(i)&&n&&this.state.inputValue?this.filterOptions(t,this.state.inputValue):t},t.prototype.resolveOption=function(e,t){var n=this;return(0,r.hEs)(e,function(e){var i=n.props.valueField||"value";return((0,r.rIu)(e,i)?e[i]:"")===t})},t.prototype.handleFocus=function(e){var t=this.props,n=t.dispatchEvent,i=t.value,o=this.resolveOptions(),a=this.resolveOption(o,i);n("focus",(0,r.vXk)(this.props,{value:i,item:a,items:o}))},t.prototype.handleBlur=function(e){var t=this.props,n=t.dispatchEvent,i=t.value,o=this.resolveOptions(),a=this.resolveOption(o,i);n("blur",(0,r.vXk)(this.props,{value:i,item:a,items:o}))},t.prototype.handleKeyPress=function(e){" "===e.key&&e.shiftKey&&(this.handleOutClick(e),e.preventDefault())},t.prototype.validate=function(){var e=this.props,t=e.value,n=e.minLength,i=e.maxLength,o=e.delimiter,r=Array.isArray(t)?t:(t?String(t):"").split(o||",");return n&&r.length<n?"已选择数量低于设定的最小个数".concat(n,"，请选择更多的选项。"):i&&r.length>i?"已选择数量超出设定的最大个数".concat(i,"，请取消选择超出的选项。"):void 0},t.prototype.removeItem=function(e,t){var n=this.props,i=n.selectedOptions,o=n.joinValues,r=n.extractValue,a=n.delimiter,l=n.valueField,s=n.onChange,p=n.disabled;if(t&&t.stopPropagation(),!p){var d=i.concat();d.splice(e,1);var u=d;o?u=d.map(function(e){return e[l||"value"]}).join(a||","):r&&(u=d.map(function(e){return e[l||"value"]})),s(u)}},t.prototype.handleChange=function(e){var t=this;this.props.multiple||this.close(),this.setState({inputValue:""},function(){return t.resultChangeEvent(e)})},t.prototype.handleTempChange=function(e){this.setState({tempValue:e})},t.prototype.handleConfirm=function(){var e=this;this.close(),this.setState({inputValue:""},function(){return e.resultChangeEvent(e.state.tempValue)})},t.prototype.handleInputChange=function(e){var t=this,n=this.props,i=n.autoComplete,o=n.data;this.setState({inputValue:e},(0,r.X1t)(i,o)?function(){return t.loadRemote(t.state.inputValue)}:void 0)},t.prototype.handleInputKeyDown=function(e){var t=this.state.inputValue,n=this.props,i=n.multiple,o=n.selectedOptions;"Backspace"===e.key&&!t&&o.length&&i&&this.removeItem(o.length-1)},t.prototype.resetValue=function(){var e,t,n=this.props,i=n.onChange,o=n.resetValue,a=n.formStore,l=n.store,s=n.name;i(null!=(t=(0,r.E04)(null!=(e=null==a?void 0:a.pristine)?e:null==l?void 0:l.pristine,s))?t:o)},t.prototype.clearValue=function(){var e=this.props,t=e.onChange,n=e.resetValue;t(void 0===n?"":n)},t.prototype.filterOptions=function(e,t){var n=this,o=this.props,r=o.labelField,a=o.valueField;return e.map(function(e){if((e=(0,i.pi)({},e)).visible=!!(0,l.Lu)([e],t,{keys:[r||"label",a||"value"],threshold:l.Lu.rankings.CONTAINS}).length,!e.visible&&e.children){e.children=n.filterOptions(e.children,t);var o=e.children.filter(function(e){return e.visible}).length;e.visible=!!o}return e.visible&&(e.collapsed=!1),e})},t.prototype.loadRemote=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,o,a,l,s,p,d,u,h;return(0,i.Jh)(this,function(c){switch(c.label){case 0:if(n=(t=this.props).autoComplete,o=t.env,a=t.data,l=t.setOptions,s=t.setLoading,p=t.source,!(0,r.X1t)(n,a)||!e&&(0,r.X1t)(p)&&!this.sourceLoaded)return this.sourceLoaded=!0,[2];if(!o||!o.fetcher)throw Error("fetcher is required");if(this.cache[e]||~e.indexOf("'"))return d=this.cache[e]||[],u=this.mergeOptions(d),l(u),[2,Promise.resolve({options:u})];s(!0),c.label=1;case 1:return c.trys.push([1,,3,4]),[4,o.fetcher(n,(0,i.pi)((0,i.pi)({},a),{term:e,value:e}))];case 2:return d=(h=c.sent()).data&&h.data.options||h.data||[],this.cache[e]=d,u=this.mergeOptions(d),l(u),[2,{options:u}];case 3:return s(!1),[7];case 4:return[2]}})})},t.prototype.mergeOptions=function(e){var t=this.props.selectedOptions,n=(0,r.GRe)(e).concat();return Array.isArray(t)&&t.length&&t.forEach(function(e){(0,r.hEs)(n,function(t){return t.value==e.value})||n.push((0,i.pi)({},e))}),n},t.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},t.prototype.handleOutClick=function(e){e.defaultPrevented||this.setState({isOpened:!0})},t.prototype.handleResultChange=function(e){var t=this.props,n=t.joinValues,i=t.extractValue,o=t.delimiter,r=t.valueField,a=t.multiple,l=Array.isArray(e)?e.concat():[];if(!a&&!l.length)return void this.resultChangeEvent("");(n||i)&&(l=e.map(function(e){return e[r||"value"]})),n&&(l=l.join(o||",")),this.resultChangeEvent(l)},t.prototype.doAction=function(e,t,n){var i,o,r,a,l;"clear"===e.actionType?this.clearValue():"reset"===e.actionType?this.resetValue():"add"===e.actionType?this.addItemFromAction(null==(i=e.args)?void 0:i.item,null==(o=e.args)?void 0:o.parentValue):"edit"===e.actionType?this.editItemFromAction(null==(r=e.args)?void 0:r.item,null==(a=e.args)?void 0:a.originValue):"delete"===e.actionType?this.deleteItemFromAction(null==(l=e.args)?void 0:l.value):"reload"===e.actionType&&this.reload()},t.prototype.addItemFromAction=function(e,t){var n=this.props,i=n.onAdd,o=n.options,a=n.valueField,l=(0,r.L$8)(o,function(e){var n=a||"value";return((0,r.rIu)(e,n)?e[n]:"")===t})||[];i&&i(l.concat(0),e,!0)},t.prototype.editItemFromAction=function(e,t){var n=this.props,o=n.onEdit,r=n.options,a=this.resolveOption(r,t);o&&a&&o((0,i.pi)((0,i.pi)({},e),{originValue:t}),a,!0)},t.prototype.deleteItemFromAction=function(e){var t=this.props,n=t.onDelete,i=t.options,o=this.resolveOption(i,e);n&&o&&n(o)},t.prototype.resultChangeEvent=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,o,a,l,s;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return n=(t=this.props).onChange,o=t.dispatchEvent,a=this.resolveOptions(),l=this.resolveOption(a,e),[4,o("change",(0,r.vXk)(this.props,{value:e,item:l,items:this.resolveOptions()}))];case 1:if(null==(s=i.sent())?void 0:s.prevented)return[2];return n&&n(e),[2]}})})},t.prototype.handleNodeClick=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,o,a;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return n=(t=this.props).dispatchEvent,o=t.data,[4,n("itemClick",(0,r.nW9)(o,{item:e}))];case 1:return null==(a=i.sent())||a.prevented,[2]}})})},t.prototype.renderOptionItem=function(e,t){var n=this.props,o=n.menuTpl,a=n.render,l=n.data;return a("option/".concat(t.index),o,{data:(0,r.nW9)((0,r.nW9)(l,(0,i.pi)({},t)),e)})},t.prototype.renderItem=function(e){var t=this.props,n=t.labelField,i=t.options;if(t.hideNodePathLabel)return e[n||"label"];var o=(0,r.kSg)(i,e,!0);return"".concat(o?o.map(function(e){return"".concat(e[n||"label"])}).join(" / "):e[n||"label"])},t.prototype.domRef=function(e){this.treeRef=e},t.prototype.renderOuter=function(){var e=this.props,t=e.value,n=e.enableNodePath,l=e.pathSeparator,s=e.disabled,p=e.joinValues,d=e.extractValue,u=e.delimiter,h=(e.placeholder,e.options),c=e.multiple,m=e.valueField,v=e.initiallyOpen,f=e.unfoldedLevel,g=e.withChildren,y=e.rootLabel,C=e.cascade,b=e.rootValue,w=e.showIcon,O=e.showRadio,I=(e.popOverContainer,e.onlyChildren),V=e.onlyLeaf,T=e.classPrefix,F=e.optionsPlaceholder,j=e.searchable,N=e.autoComplete,A=e.maxLength,R=e.minLength,P=e.labelField,E=e.deferField,S=e.nodePath,k=e.onAdd,L=e.creatable,x=e.createTip,D=e.addControls,Z=e.onEdit,B=e.editable,K=e.editTip,W=e.editControls,X=e.removable,H=e.removeTip,U=e.onDelete,G=e.rootCreatable,M=e.rootCreateTip,J=e.translate,$=e.deferLoad,_=e.expandTreeOptions,q=e.selfDisabledAffectChildren,z=e.showOutline,Q=e.autoCheckChildren,Y=e.autoCancelParent,ee=e.hideRoot,et=e.virtualThreshold,en=e.itemHeight,ei=e.menuTpl,eo=e.enableDefaultIcon,er=e.mobileUI,ea=e.testIdBuilder,el=e.nodeBehavior,es=e.itemActions,ep=e.classnames,ed=e.id,eu=e.themeCss,eh=!(0,r.X1t)(N)&&j&&this.state.inputValue?this.filterOptions(h,this.state.inputValue):h;return o.createElement(a.mp,{classPrefix:T,onRef:this.domRef,onlyChildren:I,onHandleNodeClick:this.handleNodeClick,onlyLeaf:V,labelField:P,valueField:m,deferField:E,disabled:s,onChange:er?this.handleTempChange:this.handleChange,joinValues:p,extractValue:d,delimiter:u,placeholder:J(F),options:eh,highlightTxt:this.state.inputValue,multiple:c,initiallyOpen:v,unfoldedLevel:f,withChildren:g,autoCheckChildren:Q,autoCancelParent:Y,rootLabel:J(y),rootValue:b,showIcon:w,showRadio:O,showOutline:z,cascade:C,foldedField:"collapsed",hideRoot:ee,value:t||"",nodePath:S,enableNodePath:n,pathSeparator:void 0===l?"/":l,maxLength:A,minLength:R,onAdd:k,creatable:L,createTip:x,rootCreatable:G,rootCreateTip:M,onEdit:Z,editable:B,editTip:K,removable:X,removeTip:H,onDelete:U,bultinCUD:!D&&!W,onDeferLoad:$,onExpandTree:_,selfDisabledAffectChildren:q,virtualThreshold:et,itemHeight:(0,r.He2)(en)>0?(0,r.He2)(en):void 0,itemRender:ei?this.renderOptionItem:void 0,enableDefaultIcon:eo,mobileUI:er,nodeBehavior:el,itemActionsRender:es?this.renderItemActions:void 0,actionClassName:ep((0,r.GwQ)((0,i.pi)((0,i.pi)({},this.props),{name:"actionControlClassName",id:ed,themeCss:eu}))),testIdBuilder:ea})},t.prototype.renderItemActions=function(e,t){var n=this.props,o=n.itemActions,a=n.data;return(0,n.render)("action/".concat(t.index),o||"",{data:(0,r.nW9)((0,r.nW9)(a,(0,i.pi)({},t)),e)})},t.prototype.render=function(){var e=this,t=this.props,n=t.className,l=(t.style,t.disabled),s=t.inline,p=t.loading,d=t.multiple,u=(t.value,t.clearable),h=t.classPrefix,c=t.classnames,m=t.searchable,v=t.autoComplete,f=t.selectedOptions,g=t.placeholder,y=t.popOverContainer,C=t.mobileUI,b=t.maxTagCount,w=t.overflowTagPopover,O=t.translate,I=t.env,V=t.loadingConfig,T=t.testIdBuilder,F=t.wrapperCustomStyle,j=t.id,N=t.themeCss,A=this.state.isOpened,R=d?f:f.length?this.renderItem(f[0]):"";return o.createElement(o.Fragment,null,o.createElement("div",(0,i.pi)({ref:this.container,className:c("TreeSelectControl",n)},null==T?void 0:T.getTestId()),o.createElement(a.Al,{popOverContainer:y||I.getModalContainer,maxTagCount:b,overflowTagPopover:w,disabled:l,ref:this.targetRef,placeholder:O(null!=g?g:"placeholder.empty"),inputPlaceholder:"",className:c("TreeSelect",{"TreeSelect--inline":s,"TreeSelect--single":!d,"TreeSelect--multi":d,"TreeSelect--searchable":m||(0,r.X1t)(v),"is-opened":this.state.isOpened,"is-disabled":l}),result:R,onResultClick:this.handleOutClick,value:this.state.inputValue,onChange:this.handleInputChange,onResultChange:this.handleResultChange,itemRender:this.renderItem,onKeyPress:this.handleKeyPress,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyDown:this.handleInputKeyDown,clearable:u,allowInput:!C&&(m||(0,r.X1t)(v))&&(d||!R),hasDropDownArrow:!0,readOnly:C,mobileUI:C,testIdBuilder:null==T?void 0:T.getChild("result-box")},p?o.createElement(a.$j,{loadingConfig:V,size:"sm"}):void 0),!C&&A?o.createElement(r.aVW,{container:y||function(){return e.container.current},target:function(){return e.target},show:!0},o.createElement(r.v$m,{classPrefix:h,className:"".concat(h,"TreeSelect-popover"),style:{minWidth:this.target?this.target.offsetWidth:void 0},onHide:this.close,overlay:!0},this.renderOuter())):null,C?o.createElement(a.N4,{container:I.getModalContainer,className:c("".concat(h,"TreeSelect-popup")),isShow:A,onHide:this.close,showConfirm:!0,onConfirm:this.handleConfirm},this.renderOuter()):null),o.createElement(r.cWM,(0,i.pi)({},this.props,{config:{wrapperCustomStyle:F,id:j,themeCss:N,classNames:[{key:"actionControlClassName"}]},env:I})))},t.defaultProps={hideRoot:!0,placeholder:"Select.placeholder",optionsPlaceholder:"placeholder.noData",multiple:!1,clearable:!0,rootLabel:"Tree.root",rootValue:"",showIcon:!0,joinValues:!0,extractValue:!1,delimiter:",",resetValue:"",hideNodePathLabel:!1,enableNodePath:!1,pathSeparator:"/",selfDisabledAffectChildren:!0},(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleOutClick",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Array]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleResultChange",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"addItemFromAction",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"editItemFromAction",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"deleteItemFromAction",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"resultChangeEvent",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"handleNodeClick",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"renderOptionItem",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"renderItem",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"domRef",null),(0,i.gn)([r.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"renderItemActions",null),(0,i.gn)([(0,u.i)(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"render",null),t}(o.Component),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t=(0,i.gn)([(0,r.oZB)({type:"tree-select"})],t)}(h)}}]);