"use strict";(self.webpackChunkvue2_demo=self.webpackChunkvue2_demo||[]).push([["19"],{33153:function(e,t,n){n.r(t),n.d(t,{MatrixRenderer:()=>u,default:()=>s});var r=n(9787),o=n(65758),i=n(47755),a=n(68333),l=n(81415),s=function(e){function t(t){var n=e.call(this,t)||this;return n.mounted=!1,n.toDispose=[],n.state={columns:t.columns||[],rows:t.rows||[],loading:!1},n.toggleItem=n.toggleItem.bind(n),n.reload=n.reload.bind(n),n.initOptions=n.initOptions.bind(n),n.mounted=!0,n}return(0,r.ZT)(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.formInited,n=e.addHook,r=e.formItem;r&&this.toDispose.push(t||!n?r.addInitHook(this.initOptions):n(this.initOptions,"init"))},t.prototype.componentDidUpdate=function(e){var t=this.props;if(e.columns!==t.columns||e.rows!==t.rows)this.setState({columns:t.columns||[],rows:t.rows||[]});else if(t.formInited&&(t.source!==e.source||e.data!==t.data)){var n=(0,i.xkX)(e.source,e.data,{ignoreData:!0}),r=(0,i.xkX)(t.source,t.data,{ignoreData:!0});n.url!==r.url&&(0,i.Few)(r.url)&&this.reload()}},t.prototype.componentWillUnmount=function(){this.mounted=!1,this.toDispose.forEach(function(e){return e()}),this.toDispose=[]},t.prototype.doAction=function(e,t,n){var r,o,a=this.props,l=a.resetValue,s=a.onChange,c=a.formStore,u=a.store,d=a.name,p=null==e?void 0:e.actionType;if("clear"===p)null==s||s("");else if("reset"===p){var h=null!=(o=(0,i.E04)(null!=(r=null==c?void 0:c.pristine)?r:null==u?void 0:u.pristine,d))?o:l;null==s||s(null!=h?h:"")}},t.prototype.initOptions=function(e){return(0,r.mG)(this,void 0,void 0,function(){var t,n,o;return(0,r.Jh)(this,function(r){switch(r.label){case 0:return[4,this.reload()];case 1:if(r.sent(),n=(t=this.props).formItem,o=t.name,!n)return[2];return n.value&&(0,i.NI0)(e,o,n.value),[2]}})})},t.prototype.reload=function(){return(0,r.mG)(this,void 0,void 0,function(){var e,t,n,o,a,l,s=this;return(0,r.Jh)(this,function(c){switch(c.label){case 0:if(t=(e=this.props).source,n=e.data,o=e.env,a=e.onChange,l=e.translate,!(0,i.X1t)(t,n)||this.state.loading)return[2];if(!o||!o.fetcher)throw Error("fetcher is required");return[4,new Promise(function(e,i){if(!s.mounted)return e();s.setState({loading:!0},function(){if(!s.mounted)return e();o.fetcher(t,n).then(function(n){if(!n.ok)throw Error(n.msg||l("fetchFailed"));if(!s.mounted)return e();s.setState({loading:!1,rows:n.data.rows||[],columns:n.data.columns||[]},function(){t&&t.replaceData;var o,i,l,c=n.data.value;c&&a(c=t.replaceData?c:(o=c,i=s.state.columns,l=s.state.rows,o.map(function(e,t){return e.map(function(e,n){return(0,r.pi)((0,r.pi)((0,r.pi)({},i[t]),l[n]),e)})}))),e()})}).catch(function(t){return s.setState({error:t,loading:!1},function(){return e()})})})})];case 1:return[2,c.sent()]}})})},t.prototype.toggleItem=function(e,t,n){return(0,r.mG)(this,void 0,void 0,function(){var o,a,l,s,u,d,p,h,m,f,g,v,k;return(0,r.Jh)(this,function(y){switch(y.label){case 0:if(a=(o=this.state).columns,l=o.rows,u=(s=this.props).multiple,d=s.singleSelectMode,p=s.dispatchEvent,s.data,h=this.props.value||c(a,l),u)h[t][n]=(0,r.pi)((0,r.pi)({},h[t][n]),{checked:e});else if("row"===d)for(m=0,f=a.length;m<f;m++)h[m][n]=(0,r.pi)((0,r.pi)({},h[m][n]),{checked:t===m?e:!e});else if("column"===d)for(g=0,f=l.length;g<f;g++)h[t][g]=(0,r.pi)((0,r.pi)({},h[t][g]),{checked:n===g?e:!e});else for(g=0,f=l.length;g<f;g++)for(m=0,v=a.length;m<v;m++)h[m][g]=(0,r.pi)((0,r.pi)({},h[m][g]),{checked:t===m&&n===g?e:!e});return[4,p("change",(0,i.vXk)(this.props,{value:h.concat()}))];case 1:if(null==(k=y.sent())?void 0:k.prevented)return[2];return this.props.onChange(h.concat()),[2]}})})},t.prototype.isColumChecked=function(e,t){var n=e[t];return!!n&&n.some(function(e){return e&&e.checked})},t.prototype.isColumnPartialChecked=function(e,t){var n=e[t];if(!n||1==n.length)return!1;var r=n[0].checked;return n.some(function(e){return e.checked!==r})&&!n.every(function(e){return e.checked===r})},t.prototype.toggleColumnCheckAll=function(e,t,n){return(0,r.mG)(this,void 0,void 0,function(){var o,i;return(0,r.Jh)(this,function(r){switch(r.label){case 0:o=t[n],i=0,r.label=1;case 1:if(!(i<o.length))return[3,4];return[4,this.toggleItem(e,n,i)];case 2:r.sent(),r.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},t.prototype.isRowChecked=function(e,t){return e&&e.some(function(e){return e[t]&&e[t].checked})},t.prototype.isRowPartialChecked=function(e,t){if(!e||1==e.length)return!1;var n=e[0][t].checked;return e.some(function(e){return n!==e[t].checked})&&!e.every(function(e){return e.checked})},t.prototype.toggleRowCheckAll=function(e,t,n){return(0,r.mG)(this,void 0,void 0,function(){var o;return(0,r.Jh)(this,function(r){switch(r.label){case 0:o=0,r.label=1;case 1:if(!(o<t.length))return[3,4];return[4,this.toggleItem(e,o,n)];case 2:r.sent(),r.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderInput=function(e){var t=this;void 0===e&&(e=!1);var n=this.state,r=n.columns,l=n.rows,s=this.props,u=s.rowLabel,d=s.disabled,p=s.classnames,h=s.multiple,m=s.textAlign,f=s.xCheckAll,g=s.yCheckAll,v=s.testIdBuilder,k=this.props.value||c(r,l);return o.createElement("div",{className:p("Table m-b-none",{"is-mobile":(0,i.tqC)()})},o.createElement("div",{className:p("Table-content")},o.createElement("table",{className:p("Table-table")},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,u),r.map(function(n,r){return o.createElement("th",{key:r,className:"text-"+(m||h?"left":"center")},h&&g?o.createElement(a.XZ,{type:"checkbox",disabled:e||d,checked:t.isColumChecked(k,r),partial:t.isColumnPartialChecked(k,r),onChange:function(e){return t.toggleColumnCheckAll(e,k,r)}}):null,n.label)}))),o.createElement("tbody",null,l.map(function(n,i){return o.createElement("tr",{key:i},o.createElement("td",null,h&&f?o.createElement(a.XZ,{type:"checkbox",disabled:e||d,checked:t.isRowChecked(k,i),partial:t.isRowPartialChecked(k,i),onChange:function(e){return t.toggleRowCheckAll(e,k,i)},testIdBuilder:null==v?void 0:v.getChild(i)}):null,n.label,n.description||n.desc?o.createElement("span",{className:"m-l-xs text-muted text-xs"},n.description||n.desc):null),r.map(function(n,r){return o.createElement("td",{key:r,className:"text-"+(m||h?"left":"center")},o.createElement(a.XZ,{type:h?"checkbox":"radio",disabled:e||d,checked:!!(k[r]&&k[r][i]&&k[r][i].checked),onChange:function(e){return t.toggleItem(e,r,i)},testIdBuilder:null==v?void 0:v.getChild("".concat(r,"-").concat(i))}))}))})))))},t.prototype.renderStatic=function(e){void 0===e&&(e="-");var t=this.props,n=t.className,r=(t.render,t.classnames),i=this.state.error;return o.createElement("div",{key:"input",className:r("MatrixControl",n||"")},i?e:this.renderInput(!0))},t.prototype.render=function(){var e=this.props,t=e.className,n=(e.render,e.classnames),r=e.loadingConfig,i=this.state,l=i.error,s=i.loading;return o.createElement("div",{key:"input",className:n("MatrixControl",t||"")},l?o.createElement("div",{className:n("MatrixControl-error Alert Alert--danger")},String(l)):this.renderInput(),o.createElement(a.$j,{size:"lg",overlay:!0,key:"info",show:s,loadingConfig:r}))},t.defaultProps={columns:[],rows:[],multiple:!0,singleSelectMode:"column"},(0,r.gn)([(0,l.i)(),(0,r.w6)("design:type",Function),(0,r.w6)("design:paramtypes",[]),(0,r.w6)("design:returntype",void 0)],t.prototype,"render",null),t}(o.Component);function c(e,t){return Array.isArray(e)||(e=[]),Array.isArray(t)||(t=[]),e.map(function(e){return t.map(function(t){return(0,r.pi)((0,r.pi)((0,r.pi)({},t),e),{checked:!1})})})}var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t=(0,r.gn)([(0,i.xJW)({type:"matrix-checkboxes",strictMode:!1,sizeMutable:!1})],t)}(s)}}]);