"use strict";(self.webpackChunkvue2_amis=self.webpackChunkvue2_amis||[]).push([["1462"],{12408:function(e,t,n){n.r(t),n.d(t,{App:()=>i,default:()=>s});var a=n(9787),r=n(65758),o=n(68333),l=n(47755),i=function(e){function t(t){var n,a,r,o=this;o=e.call(this,t)||this;var l=t.store;return l.syncProps(t,void 0,["pages"]),l.updateActivePage(Object.assign({},null!=(n=t.env)?n:{},{showFullBreadcrumbPath:null!=(a=t.showFullBreadcrumbPath)&&a,showBreadcrumbHomePath:null==(r=t.showBreadcrumbHomePath)||r})),t.env.watchRouteChange&&(o.unWatchRouteChange=t.env.watchRouteChange(function(){var e,n,a;return l.updateActivePage(Object.assign({},null!=(e=t.env)?e:{},{showFullBreadcrumbPath:null!=(n=t.showFullBreadcrumbPath)&&n,showBreadcrumbHomePath:null==(a=t.showBreadcrumbHomePath)||a}))})),o}return(0,a.ZT)(t,e),t.prototype.componentDidMount=function(){return(0,a.mG)(this,void 0,void 0,function(){var e,t,n;return(0,a.Jh)(this,function(a){switch(a.label){case 0:return t=(e=this.props).data,[4,(0,e.dispatchEvent)("init",t,this)];case 1:if(null==(n=a.sent())?void 0:n.prevented)return[2];return this.reload(),[2]}})})},t.prototype.componentDidUpdate=function(e){var t,n,r;return(0,a.mG)(this,void 0,void 0,function(){var o,i;return(0,a.Jh)(this,function(a){return(i=(o=this.props).store).syncProps(o,e,["pages"]),(0,l.rMT)(e.api,o.api,e.data,o.data)?this.reload():o.location&&o.location!==e.location&&i.updateActivePage(Object.assign({},null!=(t=o.env)?t:{},{showFullBreadcrumbPath:null!=(n=o.showFullBreadcrumbPath)&&n,showBreadcrumbHomePath:null==(r=o.showBreadcrumbHomePath)||r})),[2]})})},t.prototype.componentWillUnmount=function(){var e;null==(e=this.unWatchRouteChange)||e.call(this)},t.prototype.reload=function(e,t,n,r,o){return(0,a.mG)(this,void 0,void 0,function(){var e,n,r,i,s,c,u,d,p,h;return(0,a.Jh)(this,function(a){switch(a.label){case 0:if(t)return[2,this.receive(t,void 0,o)];if(n=(e=this.props).api,r=e.store,i=e.env,c=void 0!==(s=e.showFullBreadcrumbPath)&&s,d=void 0===(u=e.showBreadcrumbHomePath)||u,p=e.locale,!(0,l.X1t)(n,r.data))return[3,2];return[4,r.fetchInitData(n,r.data,{})];case 1:h=a.sent(),i.replaceText&&(h.data=(0,l.lpb)(h.data,i.replaceText,i.replaceTextIgnoreKeys)),(null==h?void 0:h.data.pages)&&(h.data=(0,l.M15)(h.data,p),r.setPages(h.data.pages),r.updateActivePage(Object.assign({},null!=i?i:{},{showFullBreadcrumbPath:c,showBreadcrumbHomePath:d}))),a.label=2;case 2:return[2,r.data]}})})},t.prototype.receive=function(e,t,n){return(0,a.mG)(this,void 0,void 0,function(){return(0,a.Jh)(this,function(t){return this.props.store.updateData(e,void 0,n),[2,this.reload()]})})},t.prototype.resolveDefinitions=function(e){var t,n=this.props,a=n.resolveDefinitions,r=null==(t=n.store.schema)?void 0:t.definitions;return(null==r?void 0:r[e])||a(e)},t.prototype.handleNavClick=function(e){e.preventDefault();var t=this.props.env,n=e.currentTarget.getAttribute("href");t.jumpTo(n,void 0,this.props.data)},t.prototype.renderHeader=function(){var e=this.props,t=e.classnames,n=e.brandName,a=e.header,l=e.render,i=e.store,s=e.logo,c=e.env;return a||s||n?r.createElement(r.Fragment,null,r.createElement("div",{className:t("Layout-brandBar")},r.createElement("div",{onClick:i.toggleOffScreen,className:t("Layout-offScreenBtn")},r.createElement("i",{className:"bui-icon iconfont icon-collapse"})),r.createElement("div",{className:t("Layout-brand")},s&&~s.indexOf("<svg")?r.createElement(o.Vt,{className:t("AppLogo-html"),html:s,filterHtml:c.filterHtml}):s?r.createElement("img",{className:t("AppLogo"),src:s}):r.createElement("span",{className:"visible-folded "},null==n?void 0:n.substring(0,1)),r.createElement("span",{className:"hidden-folded m-l-sm"},n))),r.createElement("div",{className:t("Layout-headerBar")},r.createElement("a",{onClick:i.toggleFolded,type:"button",className:t("AppFoldBtn")},r.createElement("i",{className:"fa fa-".concat(i.folded?"indent":"dedent"," fa-fw")})),a?l("header",a):null)):null},t.prototype.renderAside=function(){var e=this,t=this.props,n=t.store,a=t.env,i=t.asideBefore,s=t.asideAfter,c=t.render,u=t.data;return r.createElement(r.Fragment,null,i?c("aside-before",i):null,r.createElement(o.zo,{navigations:n.navigations,renderLink:function(t,a){var i=t.link,s=(t.active,t.toggleExpand),c=t.classnames,d=t.depth,p=t.subHeader,h=[];if(!1===i.visible)return null;!p&&i.children&&i.children.some(function(e){return null==e?void 0:e.visible})&&h.push(r.createElement("span",{key:"expand-toggle",className:c("AsideNav-itemArrow"),onClick:function(e){return s(i,e)}}));var m="string"==typeof i.badge?(0,l.hXT)(i.badge,u):i.badge;return null!=m&&h.push(r.createElement("b",{key:"badge",className:c("AsideNav-itemBadge",i.badgeClassName||"bg-info")},m)),!p&&i.icon?h.push(r.createElement(o.JO,{key:"icon",cx:c,icon:i.icon,className:"AsideNav-itemIcon"})):n.folded&&1===d&&!p&&h.push(r.createElement("i",{key:"icon",className:c("AsideNav-itemIcon",i.children?"fa fa-folder":"fa fa-info")})),h.push(r.createElement("span",{className:c("AsideNav-itemLabel"),key:"label"},"string"==typeof i.label?(0,l.hXT)(i.label,u):i.label)),i.path?/^https?\:/.test(i.path)?r.createElement("a",{target:"_blank",key:"link",href:i.path,rel:"noopener"},h):r.createElement("a",{key:"link",onClick:e.handleNavClick,href:i.path||i.children&&i.children[0].path},h):r.createElement("a",{key:"link",onClick:i.children?function(){return s(i)}:void 0},h)},isActive:function(e){return!!a.isCurrentUrl(null==e?void 0:e.path,e)}}),s?c("aside-before",s):null)},t.prototype.renderFooter=function(){var e=this.props,t=e.render,n=e.footer;return n?t("footer",n):null},t.prototype.render=function(){var e,t=this,n=this.props,a=n.classnames,l=n.store,i=n.render,s=n.showBreadcrumb,c=n.loadingConfig;return r.createElement(o.Ar,{header:this.renderHeader(),aside:this.renderAside(),footer:this.renderFooter(),folded:l.folded,offScreen:l.offScreen,contentClassName:a("AppContent")},l.activePage&&l.schema?r.createElement(r.Fragment,null,(void 0===s||s)&&l.bcn.length?r.createElement("ul",{className:a("AppBcn")},l.bcn.map(function(e,n){return r.createElement("li",{key:n,className:a("AppBcn-item")},e.path?r.createElement("a",{href:e.path,onClick:t.handleNavClick},e.label):n!==l.bcn.length-1?r.createElement("a",null,e.label):e.label)})):null,r.createElement("div",{className:a("AppBody")},i("page",l.schema,{key:"".concat(null==(e=l.activePage)?void 0:e.id,"-").concat(l.schemaKey),data:l.pageData,resolveDefinitions:this.resolveDefinitions}))):l.pages&&!l.activePage?r.createElement(o.TX,null,r.createElement("div",{className:"text-center"},"页面不存在")):null,r.createElement(o.$j,{loadingConfig:c,overlay:!0,show:l.loading||!l.pages,size:"lg"}))},t.propsList=["brandName","logo","header","asideBefore","asideAfter","pages","footer"],t.defaultProps={},(0,a.gn)([l.NjZ,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[String]),(0,a.w6)("design:returntype",void 0)],t.prototype,"resolveDefinitions",null),(0,a.gn)([l.NjZ,(0,a.w6)("design:type",Function),(0,a.w6)("design:paramtypes",[Object]),(0,a.w6)("design:returntype",void 0)],t.prototype,"handleNavClick",null),t}(r.Component),s=function(e){function t(t,n){var a=e.call(this,t)||this;return n.registerComponent(a),a}return(0,a.ZT)(t,e),t.prototype.componentWillUnmount=function(){this.context.unRegisterComponent(this),e.prototype.componentWillUnmount.call(this)},t.prototype.setData=function(e,t){return this.props.store.updateData(e,void 0,t)},t.prototype.getData=function(){return this.props.store.data},t.contextType=l.ZHe,t=(0,a.gn)([(0,l.Thl)({type:"app",storeType:l.dkQ.name}),(0,a.w6)("design:paramtypes",[Object,Object])],t)}(i)}}]);