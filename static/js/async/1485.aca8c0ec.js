"use strict";(self.webpackChunkvue2_amis=self.webpackChunkvue2_amis||[]).push([["1485"],{18168:function(e,t,n){n.r(t),n.d(t,{MultiSelectControlRenderer:()=>y,SelectControlRenderer:()=>g,default:()=>m});var o=n(9787),i=n(65758),l=n(84875),r=n.n(l),a=n(33170),s=n.n(a),u=n(66292),p=n.n(u),c=n(47755),d=n(68333),h=n(78079),v=n(81415),m=function(e){function t(t){var n=e.call(this,t)||this;return n.lastTerm="",n.fetchCancel=null,n.changeValue=n.changeValue.bind(n),n.lazyloadRemote=p()(n.loadRemote.bind(n),250,{trailing:!0,leading:!1}),n.inputRef=n.inputRef.bind(n),n}return(0,o.ZT)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.props;(0,c.X1t)(t.autoComplete,t.data)&&(0,c.rMT)(e.autoComplete,t.autoComplete,e.data,t.data)&&this.lazyloadRemote(this.lastTerm)},t.prototype.componentWillUnmount=function(){this.unHook&&this.unHook(),this.fetchCancel=null},t.prototype.inputRef=function(e){this.input=e},t.prototype.focus=function(){var e,t;this.input&&(null==(t=null==(e=this.input)?void 0:e.focus)||t.call(e))},t.prototype.getValue=function(e,t){void 0===t&&(t=[]);var n=this.props,o=n.joinValues,i=n.extractValue,l=n.delimiter,r=n.multiple,a=n.valueField,u=n.options,p=e;return(Array.isArray(e)?e:e?[e]:[]).forEach(function(e){s()(u,function(t){return t[a||"value"]==e[a||"value"]})||t.push(e)}),o?p=r?Array.isArray(e)?e.map(function(e){return e[a||"value"]}).join(l):e?e[a||"value"]:"":p?p[a||"value"]:"":i&&(p=r?Array.isArray(e)?e.map(function(e){return e[a||"value"]}):e?[e[a||"value"]]:[]:p?p[a||"value"]:""),p},t.prototype.dispatchEvent=function(e,t){return void 0===t&&(t={}),(0,o.mG)(this,void 0,void 0,function(){var n,i,l,r,a,s,u,p;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return n="on"+e.charAt(0).toUpperCase()+e.slice(1),l=(i=this.props).dispatchEvent,r=i.options,a=i.value,s=i.multiple,u=i.selectedOptions,[4,l(e,(0,c.vXk)(this.props,{options:r,items:r,value:a,selectedItems:s?u:u[0]}))];case 1:if(null==(p=o.sent())?void 0:p.prevented)return[2];return this.props[n](t),[2]}})})},t.prototype.changeValue=function(e){return(0,o.mG)(this,void 0,void 0,function(){var t,n,i,l,r,a,s,u;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return n=(t=this.props).onChange,i=t.setOptions,l=t.options,t.data,r=t.dispatchEvent,a=[],s=this.getValue(e,a),a.length&&i(l.concat(a)),[4,r("change",(0,c.vXk)(this.props,{value:s,options:l,items:l,selectedItems:e}))];case 1:if(null==(u=o.sent())?void 0:u.prevented)return[2];return null==n||n(s),[2]}})})},t.prototype.loadRemote=function(e){var t;return(0,o.mG)(this,void 0,void 0,function(){var n,i,l,r,a,s,u,p,d,h,v,m,f=this;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(i=(n=this.props).autoComplete,l=n.env,r=n.data,a=n.setOptions,s=n.setLoading,u=n.formInited,p=n.addHook,!l||!l.fetcher)throw Error("fetcher is required");if(!1===u&&p)return this.unHook&&this.unHook(),[2,this.unHook=p(this.loadRemote.bind(this,e),"init")];if(this.lastTerm=e,d=(0,c.nW9)(r,{term:e,value:e}),!(0,c.X1t)(i,d))return[2,Promise.resolve({options:[]})];this.fetchCancel&&(null==(t=this.fetchCancel)||t.call(this,"autoComplete request cancelled."),this.fetchCancel=null,s(!1)),s(!0),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,l.fetcher(i,d,{cancelExecutor:function(e){return f.fetchCancel=e}})];case 2:return h=o.sent(),this.fetchCancel=null,v=h.data&&h.data.options||h.data||[],m=this.mergeOptions(v),a(m),[2,{options:m}];case 3:return s(!1),[7];case 4:return[2]}})})},t.prototype.mergeOptions=function(e){var t=this.props,n=t.selectedOptions,i=t.valueField,l=void 0===i?"value":i,r=(0,c.GRe)(e,void 0,l).concat();return Array.isArray(n)&&n.length&&n.forEach(function(e){s()(r,function(t){return t[l]===e[l]})||r.push((0,o.pi)((0,o.pi)({},e),{hidden:!0}))}),r},t.prototype.renderMenu=function(e,t){var n=this.props,o=n.menuTpl,i=n.render,l=n.data,a=n.optionClassName,s=n.testIdBuilder;return i("menu/".concat(t.index),o,{showNativeTitle:!0,className:r()("Select-option-content",a),data:(0,c.nW9)((0,c.nW9)(l,t),e),testIdBuilder:null==s?void 0:s.getChild("option-"+e.value)})},t.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},t.prototype.option2value=function(){},t.prototype.renderOtherMode=function(){var e=this.props,t=e.selectMode,n=(0,o._T)(e,["selectMode"]);return i.createElement(f,(0,o.pi)({},n,{selectMode:"group"===t?"list":t}))},t.prototype.doAction=function(e,t,n){var o,i,l,r=this.props,a=r.resetValue,s=r.onChange,u=r.formStore,p=r.store,d=r.name,h=r.valueField,v=null==e?void 0:e.actionType;if("clear"===v)null==s||s("");else if("reset"===v){var m=null!=(l=(0,c.E04)(null!=(i=null==u?void 0:u.pristine)?i:null==p?void 0:p.pristine,d))?l:a,f=this.getValue(((o={})[h]=null!=m?m:"",o));null==s||s(f)}},t.prototype.handleOptionAdd=function(e,t,n,i){var l=this;void 0===e&&(e=-1),void 0===n&&(n=!1);var r=this.props,a=r.onAdd,s=r.autoComplete;null==a||a(e,t,n,function(){return(0,o.mG)(l,void 0,void 0,function(){return(0,o.Jh)(this,function(e){switch(e.label){case 0:if(null==i||i(t),!s)return[3,2];return[4,this.loadRemote(this.lastTerm)];case 1:return e.sent(),[2,!1];case 2:return[2]}})})})},t.prototype.handleOptionEdit=function(e,t,n,i){var l=this,r=this.props,a=r.onEdit,s=r.autoComplete;null==a||a(e,t,n,function(){return(0,o.mG)(l,void 0,void 0,function(){return(0,o.Jh)(this,function(t){switch(t.label){case 0:if(null==i||i(e),!s)return[3,2];return[4,this.loadRemote(this.lastTerm)];case 1:return t.sent(),[2,!1];case 2:return[2]}})})})},t.prototype.handleOptionDelete=function(e,t){var n=this,i=this.props,l=i.onDelete,r=i.autoComplete;null==l||l(e,function(){return(0,o.mG)(n,void 0,void 0,function(){return(0,o.Jh)(this,function(n){switch(n.label){case 0:if(null==t||t(e),!r)return[3,2];return[4,this.loadRemote(this.lastTerm)];case 1:return n.sent(),[2,!1];case 2:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.props,n=t.autoComplete,l=t.searchable,a=t.showInvalidMatch,s=t.options,u=t.className,p=t.popoverClassName,h=t.style,v=t.loading,m=(t.value,t.selectedOptions),f=t.multi,g=t.multiple,y=t.placeholder,b=t.id,C=t.classPrefix,w=(t.classnames,t.creatable),O=(t.inline,t.noResultsText),M=t.render,T=t.menuTpl,R=t.borderMode,A=t.selectMode,E=t.env,N=t.mobileUI,I=t.overlay,k=t.filterOption,F=(0,o._T)(t,["autoComplete","searchable","showInvalidMatch","options","className","popoverClassName","style","loading","value","selectedOptions","multi","multiple","placeholder","id","classPrefix","classnames","creatable","inline","noResultsText","render","menuTpl","borderMode","selectMode","env","mobileUI","overlay","filterOption"]),j=this.props,P=j.classPrefix,V=j.themeCss;return O&&(O=M("noResultText",O)),i.createElement("div",{className:r()("".concat(C,"SelectControl"),u),style:h},["table","list","group","tree","chained","associated"].includes(A)?this.renderOtherMode():i.createElement(d.Ph,(0,o.pi)({},F,{onAdd:this.handleOptionAdd,onEdit:this.handleOptionEdit,onDelete:this.handleOptionDelete,className:r()((0,c.GwQ)((0,o.pi)((0,o.pi)({},this.props),{name:"selectControlClassName",id:b,themeCss:V}))),popoverClassName:r()(p,(0,c.GwQ)((0,o.pi)((0,o.pi)({},this.props),{name:"selectPopoverClassName",id:b,themeCss:V}))),mobileUI:N,popOverContainer:N?null==E?void 0:E.getModalContainer:F.popOverContainer||E.getModalContainer,borderMode:R,placeholder:y,multiple:g||f,ref:this.inputRef,value:m,options:s,filterOption:"string"==typeof k?(0,c.PqP)(k,"options","inputValue","option"):k,loadOptions:(0,c.X1t)(n)?this.lazyloadRemote:void 0,showInvalidMatch:a,creatable:w,searchable:l||!!n,onChange:this.changeValue,onBlur:function(t){return e.dispatchEvent("blur",t)},onFocus:function(t){return e.dispatchEvent("focus",t)},loading:v,noResultsText:O,renderMenu:T?this.renderMenu:void 0,overlay:I})),i.createElement(c.cWM,(0,o.pi)({},this.props,{config:{themeCss:V,classNames:[{key:"selectControlClassName",weights:{focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"selectPopoverClassName",weights:{default:{suf:" .".concat(P,"Select-option")},hover:{suf:" .".concat(P,"Select-option.is-highlight")},focused:{inner:".".concat(P,"Select-option.is-active")}}}],id:b},env:E})))},t.defaultProps={clearable:!1,searchable:!1,multiple:!1,showInvalidMatch:!1},(0,o.gn)([c.NjZ,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[Object,Object]),(0,o.w6)("design:returntype",void 0)],t.prototype,"renderMenu",null),(0,o.gn)([c.NjZ,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[Object,Object,Boolean,Function]),(0,o.w6)("design:returntype",void 0)],t.prototype,"handleOptionAdd",null),(0,o.gn)([c.NjZ,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[Object,Object,Boolean,Function]),(0,o.w6)("design:returntype",void 0)],t.prototype,"handleOptionEdit",null),(0,o.gn)([c.NjZ,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[Object,Function]),(0,o.w6)("design:returntype",void 0)],t.prototype,"handleOptionDelete",null),(0,o.gn)([(0,v.i)(),(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[]),(0,o.w6)("design:returntype",void 0)],t.prototype,"render",null),t}(i.Component),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.prototype.renderItem=function(e){var t=this.props,n=t.labelField,o=t.menuTpl,i=t.data,l=t.render;return o?l("option/".concat(e.value),o,{data:(0,c.nW9)(i,e)}):"".concat(e.scopeLabel||"").concat(e[n||"label"])},t.prototype.render=function(){var e,t=this.props,n=t.className,o=(t.classnames,t.selectedOptions),l=t.sortable,r=t.loading,a=t.searchable,s=t.searchResultMode,u=t.showArrow,p=t.deferLoad,c=t.disabled,h=t.clearable,v=t.selectTitle,m=t.selectMode,f=t.multiple,g=t.columns,y=t.leftMode,b=t.borderMode,C=t.mobileUI,w=t.env,O=t.popOverContainer,M=t.maxTagCount,T=t.overflowTagPopover,R=t.placeholder,A=t.itemHeight,E=t.virtualThreshold,N=t.rightMode,I=t.loadingConfig,k=t.labelField,F=t.showInvalidMatch,j=t.checkAll,P=t.checkAllLabel,V=t.overlay,x=t.valueField,Z=this.props,S=Z.options,D=Z.leftOptions,G=Z.leftDefaultValue;return"associated"===m&&S&&S.length&&S[0].leftOptions&&Array.isArray(S[0].children)&&(D=S[0].leftOptions,G=null!=(e=S[0].leftDefaultValue)?e:G,S=S[0].children),i.createElement(i.Fragment,null,i.createElement(d.p_,{selectMode:m,className:n,value:o,disabled:c,clearable:h,options:S,onChange:this.handleChange,option2value:this.option2value,optionItemRender:this.renderItem,itemRender:this.renderItem,sortable:l,searchResultMode:s,onSearch:a?this.handleSearch:void 0,showArrow:u,onDeferLoad:p,selectTitle:v,multiple:f,columns:g,leftMode:y,rightMode:N,leftOptions:D,borderMode:b,mobileUI:C,popOverContainer:O||w.getModalContainer,maxTagCount:M,overflowTagPopover:T,placeholder:R,itemHeight:A,virtualThreshold:E,virtualListHeight:266,labelField:k,showInvalidMatch:F,checkAllLabel:P,checkAll:j,overlay:V,valueField:x}),i.createElement(d.$j,{overlay:!0,key:"info",show:r,loadingConfig:I}))},(0,o.gn)([c.NjZ,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[Object]),(0,o.w6)("design:returntype",Object)],t.prototype,"renderItem",null),t}(h.BaseTransferRenderer),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t=(0,o.gn)([(0,c.oZB)({type:"select"})],t)}(m),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.defaultProps={multiple:!0},t=(0,o.gn)([(0,c.oZB)({type:"multi-select"})],t)}(m)}}]);