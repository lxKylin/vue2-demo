(self.webpackChunkvue2_amis=self.webpackChunkvue2_amis||[]).push([["3954"],{56545:function(e,t,n){"use strict";n.r(t),n.d(t,{CascaderSelectControlRenderer:()=>f,NestedSelectControlRenderer:()=>m,default:()=>y});var i=n(9787),s=n(65758),r=n(68333),l=n(47755),o=n(97326),a=n(10720),u=n.n(a),c=n(29974),p=n.n(c),d=n(72976),h=n.n(d),g=n(81415),v=n(8427),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.outTarget=s.createRef(),t.state={isOpened:!1,isFocused:!1,inputValue:"",stack:[t.props.options]},t}return(0,i.ZT)(t,e),t.prototype.domRef=function(e){this.target=e},t.prototype.componentDidUpdate=function(e){e.options!==this.props.options&&this.setState({stack:[this.props.options]})},t.prototype.doAction=function(e,t,n){var i,s,r=this.props,o=r.resetValue,a=r.onChange,u=r.formStore,c=r.store,p=r.name,d=null==e?void 0:e.actionType;if("clear"===d)null==a||a("");else if("reset"===d){var h=null!=(s=(0,l.E04)(null!=(i=null==u?void 0:u.pristine)?i:null==c?void 0:c.pristine,p))?s:o;null==a||a(null!=h?h:"")}},t.prototype.dispatchEvent=function(e,t){return void 0===t&&(t={}),(0,i.mG)(this,void 0,void 0,function(){var n,s,r,o,a,u,c;return(0,i.Jh)(this,function(p){switch(p.label){case 0:return s=(n=this.props).dispatchEvent,r=n.options,o=n.multiple,a=n.value,u=n.selectedOptions,[4,s(e,(0,l.vXk)(this.props,(0,i.pi)({options:r,items:r,value:a,selectedItems:o?u:u[0]},t)))];case 1:return[2,!!(null==(c=p.sent())?void 0:c.prevented)]}})})},t.prototype.isParentNode=function(e){return Array.isArray(e.children)&&e.children.length>0},t.prototype.handleOutClick=function(e){var t;e.stopPropagation(),this.outTargetWidth=null==(t=this.outTarget.current)?void 0:t.clientWidth,e.defaultPrevented||this.setState(function(e){return{isOpened:!e.isOpened}})},t.prototype.handleResultClear=function(){this.setState({inputValue:void 0})},t.prototype.close=function(){this.setState({isOpened:!1})},t.prototype.removeItem=function(e,t){return(0,i.mG)(this,void 0,void 0,function(){var n,s,r,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return s=(n=this.props).onChange,r=n.selectedOptions,t&&t.stopPropagation(),r.splice(e,1),l=this.getValue(),[4,this.dispatchEvent("change",{value:l})];case 1:return i.sent()||s(l),[2]}})})},t.prototype.renderValue=function(e,t){var n=this.props,i=n.classnames,r=n.labelField,o=n.valueField,a=n.options,u=n.hideNodePathLabel,c=this.state.inputValue||"",p=(0,l.EvO)(c);if(u)return(0,l.ib7)(e[r||"label"]);var d=(0,l.kSg)(a,e,!0),h=(0,l.ib7)(e[r||"label"]),g=d?d.map(function(e){return(0,l.ib7)(e[r||"label"])}).join(" / "):h;return s.createElement("span",{className:i("Select-valueLabel"),key:t||e[o||"value"],title:g},d?d.map(function(e,t){var n=(0,l.ib7)(e[r||"label"]),i=e[o||"value"],a=t===d.length-1;return s.createElement("span",{key:t},p.test(i)||p.test(n)?(0,l.wy4)(n,c):n,!a&&" / ")}):h)},t.prototype.handleOptionClick=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,s,r,l,o,a,u,c;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(n=(t=this.props).multiple,s=t.onChange,r=t.joinValues,l=t.extractValue,o=t.valueField,a=t.onlyLeaf,n||void 0===(u=r||l?e[o||"value"]:e)||a&&this.isParentNode(e))return[2];return[4,this.dispatchEvent("change",{value:u})];case 1:return(c=i.sent())||s(u),c||this.handleResultClear(),this.setState({stack:[this.props.options]}),this.close(),[2]}})})},t.prototype.handleCheck=function(e,t,n){return(0,i.mG)(this,void 0,void 0,function(){var s,r,o,a,c,d,g,v,y,m,f,C,w,b,N,k,O,S,E,F,j;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(r=(s=this.props).onChange,o=s.selectedOptions,a=s.joinValues,c=s.delimiter,d=s.extractValue,g=s.withChildren,v=s.onlyChildren,y=s.cascade,m=s.options,f=s.onlyLeaf,C=this.state.stack,w=this.props.valueField||"value",f&&!Array.isArray(e)&&this.isParentNode(e))return[2];if(!Array.isArray(e)&&e.children&&e.children.length&&"number"==typeof t&&(C[t]?C.splice(t+1,1,e.children):C.push(e.children)),b=o,k=function(e){return h()((0,l.fKU)(Array.isArray(e)?e:[e],function(e){return e.children&&e.children.length?null:e}))},Array.isArray(e)?(g?e=(0,l.fKU)(e):v&&(e=k(e)),N=b.length===e.length?[]:e):Array.isArray(e.children)?y?N=u()(b,[e]):g?N=((e=(0,l.fKU)([e])).every(function(e){return!!~b.indexOf(e)})?u():p())(b,e):v?N=((e=k(e)).every(function(e){return!!~b.indexOf(e)})?u():p())(b,e):(N=b.filter(function(t){return!~(0,l.fKU)([e]).indexOf(t)}),~b.indexOf(e)||N.push(e)):N=u()(b,[e]),!y)for(S=e;;){if((null==(E=(0,l.dGi)(m,S))?void 0:E.value)&&E.children.every(function(e){return~N.indexOf(e)})){E.children.forEach(function(e){var t=N.indexOf(e);!~t||g||v||N.splice(t,1)}),v||N.push(E),S=E;continue}break}return F=a?N.map(function(e){return e[w]}).join(c):d?N.map(function(e){return e[w]}):N,[4,this.dispatchEvent("change",{value:F})];case 1:return(j=i.sent())||r(F),j||this.handleResultClear(),n&&this.setState({stack:[this.props.options]}),[2]}})})},t.prototype.allChecked=function(e){var t=this,n=this.props,i=n.selectedOptions,s=n.withChildren,r=n.onlyChildren;return e.every(function(e){return(s||r)&&e.children?t.allChecked(e.children):i.some(function(t){return t===e})})},t.prototype.partialChecked=function(e){var t=this;return e.some(function(e){return e.children&&t.partialChecked(e.children)||t.props.selectedOptions.some(function(t){return t===e})})},t.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},t.prototype.getValue=function(){var e=this.props,t=e.selectedOptions,n=e.joinValues,i=e.valueField,s=e.extractValue,r=e.delimiter,l=e.value;return n?l=t.map(function(e){return e[i||"value"]}).join(r||","):s&&(l=t.map(function(e){return e[i||"value"]})),l},t.prototype.onFocus=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,s,r;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(n=(t=this.props).onFocus,s=t.disabled,r=this.getValue(),!(!s&&!this.state.isOpened))return[3,2];return this.setState({isFocused:!0}),[4,this.dispatchEvent("focus",{value:r})];case 1:i.sent()||n&&n(e),i.label=2;case 2:return[2]}})})},t.prototype.onBlur=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return t=this.props.onBlur,n=this.getValue(),this.setState({isFocused:!1}),[4,this.dispatchEvent("blur",{value:n})];case 1:return i.sent()||t&&t(e),[2]}})})},t.prototype.getTarget=function(){return this.target||(this.target=(0,o.findDOMNode)(this)),this.target},t.prototype.handleKeyPress=function(e){" "===e.key&&(this.handleOutClick(e),e.preventDefault())},t.prototype.handleInputKeyDown=function(e){var t=this.state.inputValue,n=this.props,i=n.multiple,s=n.selectedOptions;"Backspace"===e.key&&!t&&s.length&&i&&this.removeItem(s.length-1)},t.prototype.handleInputChange=function(e){var t=this.props,n=t.options,i=t.labelField,s=t.valueField,r=e&&this.state.isOpened?(0,l.get)(n,function(t,n,r,l){return!!(0,v.Lu)([t].concat(l),e,{keys:[i||"label",s||"value"],threshold:v.Lu.rankings.CONTAINS}).length||!!(t.children&&t.children.length)},1,!0):n.concat();this.setState({inputValue:e,stack:[r]})},t.prototype.handleResultChange=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,s,r,l,o,a,u;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(n=(t=this.props).joinValues,s=t.extractValue,r=t.delimiter,l=t.valueField,o=t.onChange,a=t.multiple,u=Array.isArray(e)?e.concat():[],!(!a&&!u.length))return[3,2];return[4,this.dispatchEvent("change",{value:""})];case 1:return i.sent()||o(""),[2];case 2:return(n||s)&&(u=e.map(function(e){return e[l||"value"]})),n&&(u=u.join(r||",")),[4,this.dispatchEvent("change",{value:u})];case 3:return i.sent()||o(u),[2]}})})},t.prototype.getMenuSelectMenuStyle=function(){var e=this.props.options,t=this.outTargetWidth,n=(0,l.pk8)(e),i={};return t&&(i={width:t/n}),i},t.prototype.renderOptions=function(){var e=this,t=this.props,n=t.multiple,o=t.selectedOptions,a=t.classnames,u=t.options,c=t.disabled,p=t.checkAll,d=t.checkAllLabel,h=t.translate,g=t.labelField,v=t.menuClassName,y=t.cascade,m=t.onlyChildren,f=t.testIdBuilder,C=this.props.valueField||"value",w=this.state.stack,b=this.partialChecked(u),N=this.allChecked(u);return s.createElement(s.Fragment,null,w.map(function(t,w){return s.createElement("div",{key:w,className:a("NestedSelect-menu",v),style:e.getMenuSelectMenuStyle()},n&&p&&0===w?s.createElement("div",{className:a("NestedSelect-option","checkall")},s.createElement(r.XZ,{size:"sm",onChange:e.handleCheck.bind(e,t),checked:b,partial:b&&!N}),s.createElement("span",{onClick:e.handleCheck.bind(e,t)},h(d))):null,t.map(function(t,p){var d=null==f?void 0:f.getChild("menu-".concat(w)).getChild(t.value||p),h=(0,l.kSg)(u,t),v=null==h?void 0:h.some(function(e){return!!~o.indexOf(e)}),b=!y&&n&&v,N=null==h?void 0:h.some(function(e){return!!e.disabled}),k=b||t.disabled||N||!!c,O=!!(t.children&&e.partialChecked(t.children)),S=b||!!~o.indexOf(t);!S&&m&&n&&e.isParentNode(t)&&e.allChecked(t.children)&&(S=!0);var E=(0,l.ib7)(t[g||"label"]);return s.createElement("div",{key:p,className:a("NestedSelect-option",{"is-active":!k&&(S||!y&&O)}),onMouseEnter:e.onMouseEnter.bind(e,t,w)},n?s.createElement(r.XZ,{size:"sm",onChange:e.handleCheck.bind(e,t,w,!1),trueValue:t[C],checked:S||!y&&O,partial:!S,disabled:k,testIdBuilder:null==d?void 0:d.getChild("checkbox")}):null,s.createElement("div",(0,i.pi)({className:a("NestedSelect-optionLabel",{"is-disabled":k}),onClick:function(){return!k&&(n?e.handleCheck(t,w):e.handleOptionClick(t))},title:E},null==d?void 0:d.getTestId()),E),t.children&&t.children.length?s.createElement("div",(0,i.pi)({className:a("NestedSelect-optionArrowRight",{"is-disabled":k})},null==d?void 0:d.getChild("arrow-right").getTestId()),s.createElement(r.JO,{icon:"right-arrow-bold",className:"icon"})):null)}))}))},t.prototype.renderSearchResult=function(){var e=this,t=this.state,n=t.stack,i=t.inputValue,r=this.props,o=r.classnames,a=r.translate,u=r.options,c=r.labelField,p=r.valueField,d=r.cascade,h=r.selectedOptions,g=r.multiple,v=r.disabled,y=r.onlyChildren,m=r.render,f=this.props.noResultsText;f&&(f=m("noResultText",a(f)));var C=(0,l.EvO)(i||""),w=(0,l.fKU)(n[0]).filter(function(e){return!!(C.test(e[p||"value"])||C.test(e[c||"label"]))});return s.createElement("div",{className:o("NestedSelect-menu"),style:this.getMenuSelectMenuStyle()},w.length?w.map(function(t,n){var i=(0,l.kSg)(u,t),r=!d&&g&&(null==i?void 0:i.some(function(e){return!!~h.indexOf(e)})),a=r||t.disabled||!!v||(null==i?void 0:i.some(function(e){return!!e.disabled})),c=!!(t.children&&e.partialChecked(t.children)),p=r||!!~h.indexOf(t);return!p&&y&&e.isParentNode(t)&&e.allChecked(t.children)&&(p=!0),s.createElement("div",{className:o("NestedSelect-option",{"is-active":!a&&(p||!d&&c)}),key:n},s.createElement("div",{className:o("NestedSelect-optionLabel",{"is-disabled":a}),onClick:function(){a||(g?e.handleCheck(t,t.value,!0):e.handleOptionClick(t))}},e.renderValue(t,t.value)))}):s.createElement("div",{className:o("NestedSelect-option",{"no-result":!0})},f))},t.prototype.onMouseEnter=function(e,t,n){var i=this.state.stack;t+=1;var s=e.children;s&&s.length?i[t]?i.splice(t,1,s):i.push(s):i[t]&&i.splice(t,1),this.setState({stack:i.slice(0,t+1)})},t.prototype.renderOuter=function(){var e=this,t=this.props,n=t.popOverContainer,r=t.translate,a=t.classnames,u=t.options,c=t.render,p=t.id,d=t.themeCss,h=!!this.state.inputValue,g=this.props.noResultsText;g&&(g=c("noResultText",r(g)));var v=s.createElement(l.yzG,{disabled:!this.state.isOpened,onRootClose:this.close},function(t){return s.createElement("div",{className:a("NestedSelect-menuOuter"),ref:t},h?e.renderSearchResult():u.length?e.renderOptions():s.createElement("div",{className:a("NestedSelect-noResult")},g))});return s.createElement(l.aVW,{target:this.getTarget,container:n||function(){return(0,o.findDOMNode)(e)},placement:"auto",show:!0},s.createElement(l.v$m,{className:a("NestedSelect-popover",(0,l.GwQ)((0,i.pi)((0,i.pi)({},this.props),{name:"nestedSelectPopoverClassName",id:p,themeCss:d})))},v))},t.prototype.render=function(){var e,t=this.props,n=t.className,o=t.style,a=t.disabled,u=t.classnames,c=t.multiple,p=t.placeholder,d=t.translate,h=t.inline,g=t.searchable,v=t.selectedOptions,y=t.clearable,m=t.loading,f=t.borderMode,C=t.mobileUI,w=(t.popOverContainer,t.env),b=t.testIdBuilder,N=t.loadingConfig,k=t.maxTagCount,O=t.overflowTagPopover,S=this.props,E=S.classPrefix,F=S.themeCss,j=S.id;return s.createElement("div",{className:u("NestedSelectControl",n),ref:this.outTarget,style:o},s.createElement(r.Al,{mobileUI:C,maxTagCount:k,overflowTagPopover:O,disabled:a,ref:this.domRef,placeholder:d(null!=p?p:"placeholder.empty"),inputPlaceholder:"",className:u("NestedSelect",((e={"NestedSelect--inline":h,"NestedSelect--single":!c,"NestedSelect--multi":c,"NestedSelect--searchable":g,"is-opened":this.state.isOpened,"is-focused":this.state.isFocused})["NestedSelect--border".concat((0,l.zfV)(f))]=f,e),(0,l.GwQ)((0,i.pi)((0,i.pi)({},this.props),{name:"nestedSelectControlClassName",id:j,themeCss:F}))),result:c?v:v.length?v[0]:"",onResultClick:this.handleOutClick,value:this.state.inputValue,onChange:this.handleInputChange,onResultChange:this.handleResultChange,onClear:this.handleResultClear,itemRender:this.renderValue,onKeyPress:this.handleKeyPress,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.handleInputKeyDown,clearable:y,hasDropDownArrow:!0,allowInput:g&&!C,testIdBuilder:b},m?s.createElement(r.$j,{loadingConfig:N,size:"sm"}):void 0),C?s.createElement(r.N4,{className:u("NestedSelect-popup"),container:w.getModalContainer,isShow:this.state.isOpened,onHide:this.close,showConfirm:!1,showClose:!1},s.createElement(r.vT,(0,i.pi)({onClose:this.close},this.props,{onChange:this.handleResultChange,options:this.props.options.slice(),value:v}))):this.state.isOpened?this.renderOuter():null,s.createElement(l.cWM,(0,i.pi)({},this.props,{config:{themeCss:F,classNames:[{key:"nestedSelectControlClassName",weights:{hover:{suf:".is-clickable:not(.is-disabled)"},focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"nestedSelectPopoverClassName",weights:{default:{suf:" .".concat(E,"NestedSelect-option")},hover:{suf:" .".concat(E,"NestedSelect-option.is-highlight")},focused:{inner:".".concat(E,"NestedSelect-option.is-active")}}}],id:j},env:w})))},t.defaultProps={cascade:!1,withChildren:!1,onlyChildren:!1,onlyLeaf:!1,searchPromptText:"Select.searchPromptText",noResultsText:"noResult",checkAll:!0,checkAllLabel:"Select.checkAll",hideNodePathLabel:!1},(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"domRef",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"dispatchEvent",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleOutClick",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleResultClear",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"close",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"renderValue",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"handleOptionClick",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Number,Boolean]),(0,i.w6)("design:returntype",Promise)],t.prototype,"handleCheck",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"getValue",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"onFocus",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],t.prototype,"onBlur",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"getTarget",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleKeyPress",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleInputKeyDown",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String]),(0,i.w6)("design:returntype",void 0)],t.prototype,"handleInputChange",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Array]),(0,i.w6)("design:returntype",Promise)],t.prototype,"handleResultChange",null),(0,i.gn)([l.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"getMenuSelectMenuStyle",null),(0,i.gn)([(0,g.i)(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],t.prototype,"render",null),t}(s.Component),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t=(0,i.gn)([(0,l.oZB)({type:"nested-select"})],t)}(y),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t=(0,i.gn)([(0,l.oZB)({type:"cascader-select"})],t)}(y)},29974:function(e,t,n){var i=n(98768),s=n(5125),r=n(95453),l=n(57348);e.exports=s(function(e){return r(i(e,1,l,!0))})}}]);