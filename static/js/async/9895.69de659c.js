"use strict";(self.webpackChunkvue2_amis=self.webpackChunkvue2_amis||[]).push([["9895"],{47181:function(e,t,i){i.r(t),i.d(t,{CheckboxControlRenderer:()=>h,CityPicker:()=>c,LocationControl:()=>u,default:()=>p});var n=i(9787),r=i(65758),o=i(47755),a=i(68333),s=i(81415),l=function(e){var t,i=e.value,n=e.db,r=e.delimiter,o=void 0===r?",":r,a={code:0,province:"",provinceCode:0,city:"",cityCode:0,district:"",districtCode:0,street:""};if(!n||!i)return a;var s=i&&i.code||"number"==typeof i&&i||"string"==typeof i&&/(\d{6})/.test(i)&&RegExp.$1;if(s&&n[s]){a.code=s=parseInt(s,10);var l=s-s%1e4;n[l]&&(a.provinceCode=l,a.province=n[l]);var d=s-s%100;d!==l&&n[d]?(a.cityCode=d,a.city=n[d]):~(null==(t=n.city[l])?void 0:t.indexOf(s))&&(a.cityCode=s,a.city=n[s]),s%100&&(a.district=n[s],a.districtCode=s)}return i&&i.street?a.street=i.street:"string"==typeof i&&~i.indexOf(o)&&(a.street=i.slice(i.indexOf(o)+o.length)),a},d=function(e){i.e("128").then(i.bind(i,45478)).then(e)},c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={code:0,province:"",provinceCode:0,city:"",cityCode:0,district:"",districtCode:0,street:""},t}return(0,n.ZT)(t,e),t.prototype.componentDidMount=function(){var e=this;this.loadDb(function(){return e.syncIn()})},t.prototype.componentDidUpdate=function(e){var t=this,i=this.props;i.value!==e.value&&this.loadDb(function(){return t.syncIn(i)})},t.prototype.loadDb=function(e){var t=this;if(this.state.db){null==e||e();return}d(function(i){t.setState({db:(0,n.pi)((0,n.pi)({},i.default),{province:i.province,city:i.city,district:i.district})},e)})},t.prototype.handleProvinceChange=function(e){this.setState(e?{province:e.label,provinceCode:e.value,city:"",cityCode:0,district:"",districtCode:0,street:"",code:e?e.value:0}:{code:0,province:"",provinceCode:0,city:"",cityCode:0,district:"",districtCode:0,street:""},this.syncOut)},t.prototype.handleCityChange=function(e){if(e.value%100)return this.handleDistrictChange(e,{cityCode:e.value});this.setState(e?{city:e.label,cityCode:e.value,district:"",districtCode:0,street:"",code:e.value}:{city:"",cityCode:0,district:"",districtCode:0,street:"",code:this.state.provinceCode},this.syncOut)},t.prototype.handleDistrictChange=function(e,t){void 0===t&&(t={}),this.setState(e?(0,n.pi)((0,n.pi)({},t),{district:e.label,districtCode:e.value,street:"",code:e.value}):(0,n.pi)((0,n.pi)({},t),{district:"",districtCode:0,street:"",code:this.state.cityCode}),this.syncOut)},t.prototype.handleStreetChange=function(e){this.setState({street:e.currentTarget.value})},t.prototype.handleStreetEnd=function(){this.syncOut()},t.prototype.syncIn=function(e){void 0===e&&(e=this.props);var t=this.state.db,i=e.value,n=e.delimiter;t&&this.setState(l({value:i,delimiter:n,db:t}))},t.prototype.syncOut=function(){var e=this.props,t=e.onChange,i=e.allowStreet,n=e.joinValues,r=e.extractValue,o=e.delimiter,a=this.state,s=a.code,l=a.province,d=a.city,c=a.district,p=a.street,u=a.provinceCode,h=a.cityCode,y=a.districtCode;t((void 0===r?n:r)?s?i&&p?[s,p].join(o):String(s):"":{code:s,provinceCode:u,province:l,cityCode:h,city:d,districtCode:y,district:c,street:p})},t.prototype.render=function(){var e,t,i=this.props,o=i.classnames,s=i.className,l=(i.style,i.disabled),d=i.allowCity,c=i.allowDistrict,p=i.allowStreet,u=i.searchable,h=i.translate,y=i.loadingConfig,v=i.popOverContainer,C=i.itemClassName,g=i.testIdBuilder,f=this.state,m=f.provinceCode,b=f.cityCode,w=f.districtCode,j=f.street,O=f.db;return O?r.createElement("div",{className:o("CityPicker",s)},r.createElement(a.Ph,{className:o(C),searchable:u,disabled:l,options:O.province.map(function(e){return{label:O[e],value:e}}),value:m||"",onChange:this.handleProvinceChange,popOverContainer:v,testIdBuilder:null==g?void 0:g.getChild("province")}),d&&O.city[m]&&O.city[m].length?r.createElement(a.Ph,{className:o(C),searchable:u,disabled:l,options:O.city[m].map(function(e){return{label:O[e],value:e}}),value:b||"",onChange:this.handleCityChange,popOverContainer:v,testIdBuilder:null==g?void 0:g.getChild("city")}):null,b&&c&&(null==(t=null==(e=O.district[m])?void 0:e[b])?void 0:t.length)?r.createElement(a.Ph,{className:o(C),searchable:u,disabled:l,options:O.district[m][b].map(function(e){return{label:O[e],value:e}}),value:w||"",onChange:this.handleDistrictChange,popOverContainer:v,testIdBuilder:null==g?void 0:g.getChild("district")}):null,p&&m?r.createElement("input",(0,n.pi)({className:o("CityPicker-input"),value:j||"",onChange:this.handleStreetChange,onBlur:this.handleStreetEnd,placeholder:h("City.street"),disabled:l},null==g?void 0:g.getChild("street").getTestId())):null):r.createElement(a.$j,{show:!0,size:"sm",loadingConfig:y})},t.defaultProps={joinValues:!0,extractValue:!0,delimiter:",",allowCity:!0,allowDistrict:!0,allowStreet:!1},(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",void 0)],t.prototype,"handleProvinceChange",null),(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",void 0)],t.prototype,"handleCityChange",null),(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object]),(0,n.w6)("design:returntype",void 0)],t.prototype,"handleDistrictChange",null),(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",void 0)],t.prototype,"handleStreetChange",null),(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",void 0)],t.prototype,"handleStreetEnd",null),(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",void 0)],t.prototype,"syncIn",null),(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",void 0)],t.prototype,"syncOut",null),t}(r.Component),p=(0,o.YYN)((0,o.eAU)(c)),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={db:null},t}return(0,n.ZT)(t,e),t.prototype.doAction=function(e,t,i){var n,r,a=this.props,s=a.resetValue,l=a.onChange,d=a.formStore,c=a.store,p=a.name,u=null==e?void 0:e.actionType;if("clear"===u)l("");else if("reset"===u){var h=null!=(r=(0,o.E04)(null!=(n=null==d?void 0:d.pristine)?n:null==c?void 0:c.pristine,p))?r:s;l(null!=h?h:"")}},t.prototype.handleChange=function(e){return(0,n.mG)(this,void 0,void 0,function(){var t,i,r,a;return(0,n.Jh)(this,function(n){switch(n.label){case 0:return i=(t=this.props).dispatchEvent,r=t.onChange,[4,i("change",(0,o.vXk)(this.props,{value:e},"value"))];case 1:if(null==(a=n.sent())?void 0:a.prevented)return[2];return r(e),[2]}})})},t.prototype.renderStatic=function(e){var t=this;void 0===e&&(e="");var i=this.props,o=i.value,s=i.delimiter,c=i.loadingConfig;if(!this.state.db)return d(function(e){t.setState({db:(0,n.pi)((0,n.pi)({},e.default),{province:e.province,city:e.city,district:e.district})})}),r.createElement(a.$j,{size:"sm",show:!0,loadingConfig:c});if(!o)return r.createElement(r.Fragment,null,e);var p=l({value:o,delimiter:s,db:this.state.db}),u=p.province,h=p.city,y=p.district,v=p.street;return r.createElement(r.Fragment,null,[u,h,y,v].filter(function(e){return!!e}).join(s))},t.prototype.render=function(){var e=this.props,t=e.value,i=e.allowCity,n=e.allowDistrict,o=e.extractValue,s=e.joinValues,l=e.allowStreet,d=e.disabled,c=e.searchable,u=e.env,h=e.mobileUI,y=e.popOverContainer,v=e.itemClassName,C=e.testIdBuilder;return h?r.createElement(a.q9,{value:t,popOverContainer:null==u?void 0:u.getModalContainer,onChange:this.handleChange,allowCity:i,allowDistrict:n,extractValue:o,joinValues:s,allowStreet:l,disabled:d,mobileUI:h}):r.createElement(p,{itemClassName:v,popOverContainer:y||(null==u?void 0:u.getModalContainer),searchable:c,value:t,onChange:this.handleChange,allowCity:i,allowDistrict:n,extractValue:o,joinValues:s,allowStreet:l,disabled:d,testIdBuilder:C})},(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Boolean]),(0,n.w6)("design:returntype",void 0)],t.prototype,"doAction",null),(0,n.gn)([o.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",Promise)],t.prototype,"handleChange",null),(0,n.gn)([(0,s.i)(),(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",void 0)],t.prototype,"render",null),t}(r.Component),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.ZT)(t,e),t=(0,n.gn)([(0,o.xJW)({type:"input-city",sizeMutable:!1})],t)}(u)}}]);