"use strict";(self.webpackChunkvue2_amis=self.webpackChunkvue2_amis||[]).push([["5440"],{87189:function(e,t,a){a.r(t),a.d(t,{TabsRenderer:()=>y,default:()=>d});var n=a(9787),s=a(65758),i=a(47755),r=a(33170),o=a.n(r),l=a(33886),u=a.n(l),c=a(68333),h=a(4860),p=a.n(h),d=function(e){function t(t){var a=e.call(this,t)||this;a.newTabDefaultId=3;var s=t.location||window.location,r=t.tabs,l=t.source,u=t.data,c=0;if(void 0!==t.activeKey)c=t.activeKey;else if(s&&Array.isArray(r)){var h=s.hash.substring(1),p=o()(r,function(e){return e.hash===h});p?c=p.hash:void 0!==t.defaultKey?c="string"==typeof t.defaultKey?(0,i.OgC)(t.defaultKey,t.data):t.defaultKey:t.defaultActiveKey&&(c="string"==typeof t.defaultActiveKey?(0,i.OgC)(t.defaultActiveKey,t.data):t.defaultActiveKey),c=c||r[0]&&r[0].hash||0}var d=(0,n.CR)(a.initTabArray(r,l,u),2),y=d[0],v=d[1];return a.state={prevKey:void 0,activeKey:a.activeKey=c,localTabs:y,isFromSource:v},a}return(0,n.ZT)(t,e),t.prototype.initTabArray=function(e,t,a){if(!e)return[[],!1];var s=(0,i.OgC)(t,a,"| raw");if(!Array.isArray(s))return[e,!1];e=Array.isArray(e)?e:[e];var r=[];return s.forEach(function(t){r.push.apply(r,(0,n.ev)([],(0,n.CR)(e.map(function(e){return(0,n.pi)((0,n.pi)({},e),{data:t})})),!1))}),[r,!0]},t.prototype.componentDidMount=function(){this.autoJumpToNeighbour(this.activeKey);var e,t,a=this.props,n=a.name,s=a.value,r=a.onChange,o=a.source,l=(a.tabs,a.data),u=this.state.localTabs;if(n&&"function"==typeof r&&!o)if((s=null!=s?s:(0,i.E04)(l,n))&&Array.isArray(u)){var c=this.resolveKeyByValue(s);void 0!==c&&this.handleSelect(c)}else{var h=this.resolveTabByKey(this.activeKey);h&&s!==(null!=(e=h.value)?e:h.title)&&r(null!=(t=h.value)?t:h.title,n)}},t.prototype.componentDidUpdate=function(e,t){var a,s,r,l,u=this.props,c=this.state.localTabs,h=(0,i.OgC)(e.defaultActiveKey,e.data),p=(0,i.OgC)(u.defaultActiveKey,u.data);if((0,i.RjM)({tabs:u.tabs,source:(0,i.OgC)(u.source,u.data,"| raw")},{tabs:e.tabs,source:(0,i.OgC)(e.source,e.data,"| raw")},!1)){var d=(0,n.CR)(this.initTabArray(u.tabs,u.source,u.data),2),y=d[0],v=d[1];this.setState({localTabs:y,isFromSource:v}),c=y}if(u.location&&e.location&&u.location.hash!==e.location.hash){var m=u.location.hash.substring(1);if(!m)return;var f=o()(c,function(e){return e.hash===m});f&&f.hash&&f.hash!==this.state.activeKey&&this.setState({activeKey:this.activeKey=f.hash,prevKey:this.state.activeKey})}else if(Array.isArray(c)&&Array.isArray(t.localTabs)&&JSON.stringify(c.map(function(e){return e.hash}))!==JSON.stringify(t.localTabs.map(function(e){return e.hash}))){var b=this.state.activeKey,g=u.location,f=null;if(g&&Array.isArray(c)){var C=g.hash.substring(1);f=o()(c,function(e){return e.hash===C})}f?b=f.hash:c&&c.some(function(e,t){return e.hash?e.hash===b:t===b})||(b=c&&c[0]&&c[0].hash||0),this.setState({prevKey:void 0,activeKey:this.activeKey=b})}else if(h!==p){if(null==p)return;var K=null,f=o()(c,function(e){return e.hash===p});f?K=f.hash:"number"==typeof p&&c[p]&&(K=p),null!==K&&this.setState({prevKey:h,activeKey:this.activeKey=K})}this.autoJumpToNeighbour(this.activeKey);var T=this.props,w=T.name,N=T.value,A=T.onChange,S=T.source,O=T.data;if(w&&"function"==typeof A&&!S){if((N=null!=N?N:(0,i.E04)(O,w))!==(null!=(a=e.value)?a:(0,i.E04)(e.data,e.name))&&void 0!==(l=this.resolveKeyByValue(N))&&l!==this.activeKey)this.handleSelect(l);else if(this.activeKey!==t.activeKey){var f=this.resolveTabByKey(this.activeKey);f&&N!==(null!=(s=f.value)?s:f.title)&&A(null!=(r=f.value)?r:f.title,w)}}},t.prototype.resolveTabByKey=function(e){var t=this.state.localTabs;if(Array.isArray(t))return o()(t,function(t,a){return t.hash?t.hash===e:a===e})},t.prototype.resolveKeyByValue=function(e){var t=this.state.localTabs;if(Array.isArray(t)){var a=o()(t,function(t){var a;return(null!=(a=t.value)?a:t.title)===e});return a&&a.hash?a.hash:t.indexOf(a)}},t.prototype.autoJumpToNeighbour=function(e){var t=this.props,a=(t.tabs,t.data),n=this.state.localTabs;if(Array.isArray(n)){var s=u()(n,function(t,a){return t.hash?t.hash===e:a===e});if(n[s]&&!(0,i.pn4)(n[s],this.props.data))for(var r=n.length,o=s,l=s;o-- >=0||l++<r;){var c=null;if(o>=0&&(0,i.pn4)(n[o],a)?c=n[o].hash||o:l<r&&(0,i.pn4)(n[l],a)&&(c=n[l].hash||l),null!==c){this.setState({activeKey:this.activeKey=c});break}}}},t.prototype.handleAdd=function(){var e=this,t=this.state.localTabs.concat();t.push({title:"tab".concat(this.newTabDefaultId++),body:"tab"}),this.setState({localTabs:t},function(){e.switchTo(e.state.localTabs.length-1)})},t.prototype.handleClose=function(e,t){return(0,n.mG)(this,void 0,void 0,function(){var a,s,r;return(0,n.Jh)(this,function(n){switch(n.label){case 0:if(-1===(s=null==(a=this.state.localTabs.concat())?void 0:a.findIndex(function(a,n){var s;return e===(t?a.hash:null!=(s=a.hash)?s:n)})))return[2];return a.splice(s,1),[4,(0,this.props.dispatchEvent)("delete",(0,i.vXk)(this.props,{value:e}))];case 1:if(null==(r=n.sent())?void 0:r.prevented)return[2];return this.setState({localTabs:a}),[2]}})})},t.prototype.handleEdit=function(e,t){var a=this.state.localTabs.concat();a[e].title=t,this.setState({localTabs:a})},t.prototype.handleDragChange=function(e){return(0,n.mG)(this,void 0,void 0,function(){var t,a,s=this;return(0,n.Jh)(this,function(n){return t=this.resolveTabByKey(this.activeKey),(a=this.state.localTabs.concat()).splice(e.newIndex,0,a.splice(e.oldIndex,1)[0]),this.setState({localTabs:a},function(){if(t){var e=a.indexOf(t);s.switchTo(e)}}),[2]})})},t.prototype.handleSelect=function(e){var t;return(0,n.mG)(this,void 0,void 0,function(){var a,s,r,o,l,u,c,h,p;return(0,n.Jh)(this,function(n){switch(n.label){case 0:if(s=(a=this.props).dispatchEvent,a.data,r=a.env,o=a.onSelect,l=a.id,!(c=null==(u=this.state.localTabs)?void 0:u.find(function(t,a){return e===(t.hash?t.hash:a)})))return[2];return null==(t=r.tracker)||t.call(r,{eventType:"tabChange",eventData:{id:l,key:e}}),[4,s("change",(0,i.vXk)(this.props,{value:(null==c?void 0:c.hash)?null==c?void 0:c.hash:e+1}))];case 1:if(null==(h=n.sent())?void 0:h.prevented)return[2];return"string"==typeof e&&r?r.updateLocation("#".concat(e)):"string"==typeof this.state.activeKey&&r&&r.updateLocation("#"),this.setState({activeKey:this.activeKey=e,prevKey:this.state.activeKey}),"string"==typeof o?(p=(0,i.S0D)(o,"key","props"))&&p(e,this.props):"function"==typeof o&&o(e,this.props),[2]}})})},t.prototype.doAction=function(e,t,a,n){void 0===a&&(a=!1);var s=null==e?void 0:e.actionType,i=Number(null==n?void 0:n.activeKey),r=p()(i)?null==n?void 0:n.activeKey:i,o=null==n?void 0:n.deleteHash;"changeActiveKey"===s?this.handleSelect("number"==typeof r?r-1:r):"deleteTab"===s&&this.handleClose(o,!0)},t.prototype.switchTo=function(e){var t=this.state.localTabs;Array.isArray(t)&&t[e]&&this.setState({activeKey:this.activeKey=t[e].hash||e})},t.prototype.currentIndex=function(){var e=this,t=this.state.localTabs;return Array.isArray(t)?u()(t,function(t,a){return t.hash?t.hash===e.state.activeKey:a===e.state.activeKey}):-1},t.prototype.renderTabTitle=function(e,t,a){var s=this.props.render;return"string"!=typeof e&&e?s("tab-title/".concat(t),e,{data:(0,n.pi)({index:t,__index:t},a)}):(0,i.hXT)(e,a)},t.prototype.renderToolbar=function(){var e=this.props,t=e.toolbar,a=e.render,r=e.classnames,o=e.toolbarClassName,l=e.id,u=e.themeCss;return t?s.createElement("div",{className:r("Tabs-toolbar",o,(0,i.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"toolbarControlClassName",id:l,themeCss:u})))},a("toolbar",t)):null},t.prototype.renderTabs=function(){var e=this,t=this.props,a=t.classnames,r=t.classPrefix,o=t.contentClassName,l=t.linksClassName,u=t.tabRender,h=t.className,p=t.style,d=t.render,y=t.data,v=t.mode,m=t.tabsMode,f=t.unmountOnExit,b=(t.source,t.formStore),g=t.formMode,C=t.formHorizontal,K=t.subFormMode,T=t.subFormHorizontal,w=t.addable,N=t.closable,A=t.draggable,S=t.showTip,O=t.showTipClassName,E=t.editable,x=t.sidePosition,k=t.translate,j=t.addBtnText,B=t.collapseOnExceed,F=t.collapseBtnLabel,I=t.disabled,Z=t.mobileUI,D=t.swipeable,G=t.testIdBuilder,M=t.id,J=t.wrapperCustomStyle,R=t.themeCss,P=t.env,H=this.props.mountOnEnter;b&&(H=!1);var Q=this.state,U=Q.localTabs,W=Q.isFromSource,z=[],_=[];return W?(z=U.map(function(t,r){var o,l,u=(0,i.nW9)(y,(0,i.Kn2)(t.data)?(0,n.pi)({index:r},t.data):{item:t.data,index:r});return(0,i.pn4)(t,u)?s.createElement(c.OK,(0,n.pi)({},t,{title:e.renderTabTitle(t.title,r,u),disabled:I||(0,i.pKY)(t,u),key:r,eventKey:(0,i.hXT)(t.hash,u)||r,prevKey:r>0?(null==(o=U[r-1])?void 0:o.hash)||r-1:0,nextKey:r<U.length-1?(null==(l=U[r+1])?void 0:l.hash)||r+1:U.length-1,swipeable:D,mobileUI:Z,mountOnEnter:H,unmountOnExit:"boolean"==typeof t.reload?t.reload:"boolean"==typeof t.unmountOnExit?t.unmountOnExit:f,onSelect:e.handleSelect,testIdBuilder:null==G?void 0:G.getChild("tab-".concat("string"==typeof t.title?t.title:r)),className:a(t.className,(0,i.GwQ)((0,n.pi)((0,n.pi)({},t),{name:"panelControlClassName",id:t.id,themeCss:t.themeCss})))}),d("item/".concat(r),(null==t?void 0:t.type)?t:t.tab||t.body,{disabled:I||(0,i.pKY)(t,u)||void 0,data:u,formMode:t.mode||K||g,formHorizontal:t.horizontal||T||C})):null}),_=U.map(function(t,a){var r=(0,i.nW9)(y,(0,i.Kn2)(t.data)?(0,n.pi)({index:a},t.data):{item:t.data,index:a});return(0,i.pn4)(t,r)?s.createElement(i.cWM,(0,n.pi)({},t,{config:{id:t.id,themeCss:t.themeCss,classNames:[{key:"panelControlClassName"}]},env:e.props.env,key:"customstyle_".concat(a)})):null})):(z=U.map(function(t,r){var o,l;return(0,i.pn4)(t,y)?s.createElement(c.OK,(0,n.pi)({},t,{title:e.renderTabTitle(t.title,r,y),disabled:I||(0,i.pKY)(t,y),key:r,eventKey:t.hash||r,prevKey:r>0?(null==(o=U[r-1])?void 0:o.hash)||r-1:0,nextKey:r<U.length-1?(null==(l=U[r+1])?void 0:l.hash)||r+1:U.length-1,swipeable:D,mobileUI:Z,mountOnEnter:H,unmountOnExit:"boolean"==typeof t.reload?t.reload:"boolean"==typeof t.unmountOnExit?t.unmountOnExit:f,onSelect:e.handleSelect,testIdBuilder:null==G?void 0:G.getChild("tab-".concat("string"==typeof t.title?t.title:r)),className:a(t.className,(0,i.GwQ)((0,n.pi)((0,n.pi)({},t),{name:"panelControlClassName",id:t.id,themeCss:t.themeCss})))}),e.renderTab?e.renderTab(t,e.props,r):u?u(t,e.props,r):d("tab/".concat(r),(null==t?void 0:t.type)?t:t.tab||t.body,{disabled:I||(0,i.pKY)(t,y)||void 0,formMode:t.mode||K||g,formHorizontal:t.horizontal||T||C})):null}),_=U.map(function(t,a){return(0,i.pn4)(t,y)?s.createElement(i.cWM,{config:{id:t.id,themeCss:t.themeCss,classNames:[{key:"panelControlClassName"}]},env:e.props.env,key:"customstyle_".concat(a)}):null})),s.createElement(s.Fragment,null,s.createElement(c.mQ,{addBtnText:k(j||"add"),classPrefix:r,classnames:a,mode:m||v,closable:N,className:a(h,(0,i.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"wrapperCustomStyle",id:M,themeCss:J}))),style:p,contentClassName:a(o,(0,i.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"contentControlClassName",id:M,themeCss:R}))),linksClassName:l,titleClassName:a((0,i.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"titleControlClassName",id:M,themeCss:R}))),onSelect:this.handleSelect,activeKey:this.state.activeKey,toolbar:this.renderToolbar(),addable:w,onAdd:this.handleAdd,onClose:this.handleClose,draggable:A,onDragChange:this.handleDragChange,showTip:S,showTipClassName:O,editable:E,onEdit:this.handleEdit,sidePosition:x,collapseOnExceed:B,collapseBtnLabel:F,mobileUI:Z,testIdBuilder:G},z),_,s.createElement(i.cWM,(0,n.pi)({},this.props,{config:{wrapperCustomStyle:J,id:M,themeCss:R,classNames:[{key:"titleControlClassName",weights:{default:{important:!0,inner:"> a"},focused:{important:!0,suf:".is-active",inner:"> a"},hover:{important:!0,inner:"> a"},disabled:{important:!0,suf:".is-disabled",inner:"> a"}}},{key:"toolbarControlClassName",weights:{default:{important:!0}}},{key:"contentControlClassName",weights:{default:{important:!0}}}]},env:P})))},t.prototype.render=function(){return this.renderTabs()},t.defaultProps={className:"",mode:"",mountOnEnter:!0,unmountOnExit:!1},(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Array,String,Object]),(0,n.w6)("design:returntype",Array)],t.prototype,"initTabArray",null),(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",void 0)],t.prototype,"autoJumpToNeighbour",null),(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",void 0)],t.prototype,"handleAdd",null),(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Boolean]),(0,n.w6)("design:returntype",Promise)],t.prototype,"handleClose",null),(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Number,String]),(0,n.w6)("design:returntype",void 0)],t.prototype,"handleEdit",null),(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",Promise)],t.prototype,"handleDragChange",null),(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",Promise)],t.prototype,"handleSelect",null),(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Number]),(0,n.w6)("design:returntype",void 0)],t.prototype,"switchTo",null),(0,n.gn)([i.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",Number)],t.prototype,"currentIndex",null),t}(s.Component),y=function(e){function t(t,a){var n=e.call(this,t)||this;return a.registerComponent(n),n}return(0,n.ZT)(t,e),t.prototype.componentWillUnmount=function(){var t;null==(t=e.prototype.componentWillUnmount)||t.call(this),this.context.unRegisterComponent(this)},t.contextType=i.ZHe,t=(0,n.gn)([(0,i.Thl)({type:"tabs",onGlobalVarChanged:function(e,t,a){if((0,i.RuH)(t.source)){var s=(0,n.CR)(e.initTabArray(e.props.tabs,e.props.source,a),2),r=s[0],o=s[1];return e.setState({localTabs:r,isFromSource:o}),!1}}}),(0,n.w6)("design:paramtypes",[Object,Object])],t)}(d)}}]);